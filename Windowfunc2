-+
| @@session.sql_mode                                                                                                    |
+-----------------------------------------------------------------------------------------------------------------------+
| ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION |
+-----------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> insert into dat(dta) values('2024-00-09');
ERROR 1292 (22007): Incorrect date value: '2024-00-09' for column 'Dta' at row 1
mysql> select * from dat;
+------------+
| Dta        |
+------------+
| 2024-00-09 |
| 0000-00-00 |
| 0000-00-00 |
+------------+
3 rows in set (0.00 sec)

mysql> show mysql --version;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'mysql --version' at line 1
mysql> quit;
Bye
RadhaPutraAbhishektyagi@Abhisheks-MacBook-Air ~ % mysql --version;
mysql  Ver 8.0.31 for macos12 on arm64 (MySQL Community Server - GPL)
RadhaPutraAbhishektyagi@Abhisheks-MacBook-Air ~ % 
  [Restored 14 Sep 2024 at 10:33:05â€¯AM]
Last login: Sat Sep 14 10:33:01 on console
RadhaPutraAbhishektyagi@Abhisheks-MacBook-Air ~ % clear;

RadhaPutraAbhishektyagi@Abhisheks-MacBook-Air ~ % mysql -u root -p;
Enter password: 
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 8
Server version: 8.0.31 MySQL Community Server - GPL

Copyright (c) 2000, 2022, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> show databases;
+----------------------+
| Database             |
+----------------------+
| ABES                 |
| Aggregate            |
| bankmanagementsystem |
| Books                |
| BookShop             |
| constraints          |
| DBMS                 |
| information_schema   |
| mysql                |
| performance_schema   |
| Practice             |
| RadheKrishna         |
| Shirt                |
| Student              |
| sys                  |
| Triggers             |
| Tv_db                |
| View                 |
+----------------------+
18 rows in set (0.00 sec)

mysql> use tv_db;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> show tables;
+-----------------+
| Tables_in_tv_db |
+-----------------+
| Dat             |
| full_review     |
| reviewers       |
| reviews         |
| series          |
+-----------------+
5 rows in set (0.00 sec)

mysql> show create view Dat;
ERROR 1347 (HY000): 'tv_db.dat' is not VIEW
mysql> show create view full_review;
+-------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+
| View        | Create View                                                                                                                                                                                                                                                                                                                                                                                                                                                               | character_set_client | collation_connection |
+-------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+
| full_review | CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `full_review` AS select `series`.`title` AS `title`,`series`.`released_year` AS `released_year`,`series`.`genre` AS `genre`,`reviews`.`rating` AS `rating`,`reviewers`.`first_name` AS `first_name`,`reviewers`.`last_name` AS `last_Name` from ((`reviews` join `series` on((`reviews`.`series_id` = `series`.`id`))) join `reviewers` on((`reviewers`.`id` = `reviews`.`reviewer_id`))) | utf8mb4              | utf8mb4_0900_ai_ci   |
+-------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+
1 row in set (0.00 sec)

mysql> show tables;
+-----------------+
| Tables_in_tv_db |
+-----------------+
| Dat             |
| full_review     |
| reviewers       |
| reviews         |
| series          |
+-----------------+
5 rows in set (0.00 sec)

mysql> select @@session.sql_mode;
+-----------------------------------------------------------------------------------------------------------------------+
| @@session.sql_mode                                                                                                    |
+-----------------------------------------------------------------------------------------------------------------------+
| ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION |
+-----------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> select @@global.sql_mode;
+-----------------------------------------------------------------------------------------------------------------------+
| @@global.sql_mode                                                                                                     |
+-----------------------------------------------------------------------------------------------------------------------+
| ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION |
+-----------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> show tables;
+-----------------+
| Tables_in_tv_db |
+-----------------+
| Dat             |
| full_review     |
| reviewers       |
| reviews         |
| series          |
+-----------------+
5 rows in set (0.00 sec)

mysql> desc Series;
+---------------+--------------+------+-----+---------+----------------+
| Field         | Type         | Null | Key | Default | Extra          |
+---------------+--------------+------+-----+---------+----------------+
| id            | int          | NO   | PRI | NULL    | auto_increment |
| title         | varchar(100) | YES  |     | NULL    |                |
| released_year | year         | YES  |     | NULL    |                |
| genre         | varchar(100) | YES  |     | NULL    |                |
+---------------+--------------+------+-----+---------+----------------+
4 rows in set (0.00 sec)

mysql> select * from series;
+----+-----------------------+---------------+-----------+
| id | title                 | released_year | genre     |
+----+-----------------------+---------------+-----------+
|  1 | Archer                |          2009 | Animation |
|  2 | Arrested Development  |          2003 | Comedy    |
|  3 | Bob's Burgers         |          2011 | Animation |
|  4 | Bojack Horseman       |          2014 | Animation |
|  5 | Breaking Bad          |          2008 | Drama     |
|  6 | Curb Your Enthusiasm  |          2000 | Comedy    |
|  7 | Fargo                 |          2014 | Drama     |
|  8 | Freaks and Geeks      |          1999 | Comedy    |
|  9 | General Hospital      |          1963 | Drama     |
| 10 | Halt and Catch Fire   |          2014 | Drama     |
| 11 | Malcolm In The Middle |          2000 | Comedy    |
| 12 | Pushing Daisies       |          2007 | Comedy    |
| 13 | Seinfeld              |          1989 | Comedy    |
| 14 | Stranger Things       |          2016 | Drama     |
+----+-----------------------+---------------+-----------+
14 rows in set (0.00 sec)

mysql> insert into series(genre)values(12.32);
Query OK, 1 row affected (0.00 sec)

mysql> select * from series;
+----+-----------------------+---------------+-----------+
| id | title                 | released_year | genre     |
+----+-----------------------+---------------+-----------+
|  1 | Archer                |          2009 | Animation |
|  2 | Arrested Development  |          2003 | Comedy    |
|  3 | Bob's Burgers         |          2011 | Animation |
|  4 | Bojack Horseman       |          2014 | Animation |
|  5 | Breaking Bad          |          2008 | Drama     |
|  6 | Curb Your Enthusiasm  |          2000 | Comedy    |
|  7 | Fargo                 |          2014 | Drama     |
|  8 | Freaks and Geeks      |          1999 | Comedy    |
|  9 | General Hospital      |          1963 | Drama     |
| 10 | Halt and Catch Fire   |          2014 | Drama     |
| 11 | Malcolm In The Middle |          2000 | Comedy    |
| 12 | Pushing Daisies       |          2007 | Comedy    |
| 13 | Seinfeld              |          1989 | Comedy    |
| 14 | Stranger Things       |          2016 | Drama     |
| 16 | NULL                  |          NULL | 12.32     |
+----+-----------------------+---------------+-----------+
15 rows in set (0.00 sec)

mysql> delete from series where id=16;
Query OK, 1 row affected (0.01 sec)

mysql> select * from series;
+----+-----------------------+---------------+-----------+
| id | title                 | released_year | genre     |
+----+-----------------------+---------------+-----------+
|  1 | Archer                |          2009 | Animation |
|  2 | Arrested Development  |          2003 | Comedy    |
|  3 | Bob's Burgers         |          2011 | Animation |
|  4 | Bojack Horseman       |          2014 | Animation |
|  5 | Breaking Bad          |          2008 | Drama     |
|  6 | Curb Your Enthusiasm  |          2000 | Comedy    |
|  7 | Fargo                 |          2014 | Drama     |
|  8 | Freaks and Geeks      |          1999 | Comedy    |
|  9 | General Hospital      |          1963 | Drama     |
| 10 | Halt and Catch Fire   |          2014 | Drama     |
| 11 | Malcolm In The Middle |          2000 | Comedy    |
| 12 | Pushing Daisies       |          2007 | Comedy    |
| 13 | Seinfeld              |          1989 | Comedy    |
| 14 | Stranger Things       |          2016 | Drama     |
+----+-----------------------+---------------+-----------+
14 rows in set (0.00 sec)

mysql> insert into series(id)values(12.32);
ERROR 1062 (23000): Duplicate entry '12' for key 'series.PRIMARY'
mysql> insert into series(released_year)values(12.32);
Query OK, 1 row affected (0.00 sec)

mysql> select * from series;
+----+-----------------------+---------------+-----------+
| id | title                 | released_year | genre     |
+----+-----------------------+---------------+-----------+
|  1 | Archer                |          2009 | Animation |
|  2 | Arrested Development  |          2003 | Comedy    |
|  3 | Bob's Burgers         |          2011 | Animation |
|  4 | Bojack Horseman       |          2014 | Animation |
|  5 | Breaking Bad          |          2008 | Drama     |
|  6 | Curb Your Enthusiasm  |          2000 | Comedy    |
|  7 | Fargo                 |          2014 | Drama     |
|  8 | Freaks and Geeks      |          1999 | Comedy    |
|  9 | General Hospital      |          1963 | Drama     |
| 10 | Halt and Catch Fire   |          2014 | Drama     |
| 11 | Malcolm In The Middle |          2000 | Comedy    |
| 12 | Pushing Daisies       |          2007 | Comedy    |
| 13 | Seinfeld              |          1989 | Comedy    |
| 14 | Stranger Things       |          2016 | Drama     |
| 17 | NULL                  |          2012 | NULL      |
+----+-----------------------+---------------+-----------+
15 rows in set (0.00 sec)

mysql> delete from series where id=17;
Query OK, 1 row affected (0.01 sec)

mysql> select * from series;
+----+-----------------------+---------------+-----------+
| id | title                 | released_year | genre     |
+----+-----------------------+---------------+-----------+
|  1 | Archer                |          2009 | Animation |
|  2 | Arrested Development  |          2003 | Comedy    |
|  3 | Bob's Burgers         |          2011 | Animation |
|  4 | Bojack Horseman       |          2014 | Animation |
|  5 | Breaking Bad          |          2008 | Drama     |
|  6 | Curb Your Enthusiasm  |          2000 | Comedy    |
|  7 | Fargo                 |          2014 | Drama     |
|  8 | Freaks and Geeks      |          1999 | Comedy    |
|  9 | General Hospital      |          1963 | Drama     |
| 10 | Halt and Catch Fire   |          2014 | Drama     |
| 11 | Malcolm In The Middle |          2000 | Comedy    |
| 12 | Pushing Daisies       |          2007 | Comedy    |
| 13 | Seinfeld              |          1989 | Comedy    |
| 14 | Stranger Things       |          2016 | Drama     |
+----+-----------------------+---------------+-----------+
14 rows in set (0.00 sec)

mysql> desc series;
+---------------+--------------+------+-----+---------+----------------+
| Field         | Type         | Null | Key | Default | Extra          |
+---------------+--------------+------+-----+---------+----------------+
| id            | int          | NO   | PRI | NULL    | auto_increment |
| title         | varchar(100) | YES  |     | NULL    |                |
| released_year | year         | YES  |     | NULL    |                |
| genre         | varchar(100) | YES  |     | NULL    |                |
+---------------+--------------+------+-----+---------+----------------+
4 rows in set (0.00 sec)

mysql> insert into series(released_year)values('Abhi');
ERROR 1366 (HY000): Incorrect integer value: 'Abhi' for column 'released_year' at row 1
mysql> set session sql_mode='';
Query OK, 0 rows affected (0.00 sec)

mysql> insert into series(released_year)values('Abhi');
Query OK, 1 row affected, 1 warning (0.00 sec)

mysql> show warinings;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'warinings' at line 1
mysql> show warnings;
+-------+------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Level | Code | Message                                                                                                                                                     |
+-------+------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Error | 1064 | You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'warinings' at line 1 |
+-------+------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> select * from series;
+----+-----------------------+---------------+-----------+
| id | title                 | released_year | genre     |
+----+-----------------------+---------------+-----------+
|  1 | Archer                |          2009 | Animation |
|  2 | Arrested Development  |          2003 | Comedy    |
|  3 | Bob's Burgers         |          2011 | Animation |
|  4 | Bojack Horseman       |          2014 | Animation |
|  5 | Breaking Bad          |          2008 | Drama     |
|  6 | Curb Your Enthusiasm  |          2000 | Comedy    |
|  7 | Fargo                 |          2014 | Drama     |
|  8 | Freaks and Geeks      |          1999 | Comedy    |
|  9 | General Hospital      |          1963 | Drama     |
| 10 | Halt and Catch Fire   |          2014 | Drama     |
| 11 | Malcolm In The Middle |          2000 | Comedy    |
| 12 | Pushing Daisies       |          2007 | Comedy    |
| 13 | Seinfeld              |          1989 | Comedy    |
| 14 | Stranger Things       |          2016 | Drama     |
| 18 | NULL                  |          0000 | NULL      |
+----+-----------------------+---------------+-----------+
15 rows in set (0.00 sec)

mysql> | NULL      |
    -> +----+-----------------------+---^C
mysql> set session sql_mode='Strict_trans_table';
ERROR 1231 (42000): Variable 'sql_mode' can't be set to the value of 'Strict_trans_table'
mysql> set session sql_mode='Strict_trans_table';
ERROR 1231 (42000): Variable 'sql_mode' can't be set to the value of 'Strict_trans_table'
mysql> select @@global.sql_mode;
+-----------------------------------------------------------------------------------------------------------------------+
| @@global.sql_mode                                                                                                     |
+-----------------------------------------------------------------------------------------------------------------------+
| ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION |
+-----------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> set session sql_mode='Strict_trans_tables';
Query OK, 0 rows affected, 1 warning (0.00 sec)

mysql> insert into series(released_year)values('Abhi');
ERROR 1366 (HY000): Incorrect integer value: 'Abhi' for column 'released_year' at row 1
mysql> set session sql_mode='';
Query OK, 0 rows affected (0.00 sec)

mysql> insert into series(released_year)values('Abhi');
Query OK, 1 row affected, 1 warning (0.00 sec)

mysql> select * from series;
+----+-----------------------+---------------+-----------+
| id | title                 | released_year | genre     |
+----+-----------------------+---------------+-----------+
|  1 | Archer                |          2009 | Animation |
|  2 | Arrested Development  |          2003 | Comedy    |
|  3 | Bob's Burgers         |          2011 | Animation |
|  4 | Bojack Horseman       |          2014 | Animation |
|  5 | Breaking Bad          |          2008 | Drama     |
|  6 | Curb Your Enthusiasm  |          2000 | Comedy    |
|  7 | Fargo                 |          2014 | Drama     |
|  8 | Freaks and Geeks      |          1999 | Comedy    |
|  9 | General Hospital      |          1963 | Drama     |
| 10 | Halt and Catch Fire   |          2014 | Drama     |
| 11 | Malcolm In The Middle |          2000 | Comedy    |
| 12 | Pushing Daisies       |          2007 | Comedy    |
| 13 | Seinfeld              |          1989 | Comedy    |
| 14 | Stranger Things       |          2016 | Drama     |
| 18 | NULL                  |          0000 | NULL      |
| 19 | NULL                  |          0000 | NULL      |
+----+-----------------------+---------------+-----------+
16 rows in set (0.00 sec)

mysql> delete from series where id=18,19;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ',19' at line 1
mysql> delete from series where id in(18,19);
Query OK, 2 rows affected (0.00 sec)

mysql> select * from series;
+----+-----------------------+---------------+-----------+
| id | title                 | released_year | genre     |
+----+-----------------------+---------------+-----------+
|  1 | Archer                |          2009 | Animation |
|  2 | Arrested Development  |          2003 | Comedy    |
|  3 | Bob's Burgers         |          2011 | Animation |
|  4 | Bojack Horseman       |          2014 | Animation |
|  5 | Breaking Bad          |          2008 | Drama     |
|  6 | Curb Your Enthusiasm  |          2000 | Comedy    |
|  7 | Fargo                 |          2014 | Drama     |
|  8 | Freaks and Geeks      |          1999 | Comedy    |
|  9 | General Hospital      |          1963 | Drama     |
| 10 | Halt and Catch Fire   |          2014 | Drama     |
| 11 | Malcolm In The Middle |          2000 | Comedy    |
| 12 | Pushing Daisies       |          2007 | Comedy    |
| 13 | Seinfeld              |          1989 | Comedy    |
| 14 | Stranger Things       |          2016 | Drama     |
+----+-----------------------+---------------+-----------+
14 rows in set (0.00 sec)

mysql> select @@session.sql_mode;
+--------------------+
| @@session.sql_mode |
+--------------------+
|                    |
+--------------------+
1 row in set (0.00 sec)

mysql> quit;
Bye
RadhaPutraAbhishektyagi@Abhisheks-MacBook-Air ~ % mysql -u root -p;
Enter password: 
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 11
Server version: 8.0.31 MySQL Community Server - GPL

Copyright (c) 2000, 2022, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> show tables;
ERROR 1046 (3D000): No database selected
mysql> show databases;
+----------------------+
| Database             |
+----------------------+
| ABES                 |
| Aggregate            |
| bankmanagementsystem |
| Books                |
| BookShop             |
| constraints          |
| DBMS                 |
| information_schema   |
| mysql                |
| performance_schema   |
| Practice             |
| RadheKrishna         |
| Shirt                |
| Student              |
| sys                  |
| Triggers             |
| Tv_db                |
| View                 |
+----------------------+
18 rows in set (0.01 sec)

mysql> use tv_db;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> show tables;
+-----------------+
| Tables_in_tv_db |
+-----------------+
| Dat             |
| full_review     |
| reviewers       |
| reviews         |
| series          |
+-----------------+
5 rows in set (0.00 sec)

mysql> select @@session.sql_mode;
+-----------------------------------------------------------------------------------------------------------------------+
| @@session.sql_mode                                                                                                    |
+-----------------------------------------------------------------------------------------------------------------------+
| ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION |
+-----------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> select @@global.sql_mode;
+-----------------------------------------------------------------------------------------------------------------------+
| @@global.sql_mode                                                                                                     |
+-----------------------------------------------------------------------------------------------------------------------+
| ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION |
+-----------------------------------------------------------------------------------------------------------------------+
1 row in set (0.01 sec)

mysql> -- sQL mode 
mysql> select 4/0;
+------+
| 4/0  |
+------+
| NULL |
+------+
1 row in set, 1 warning (0.00 sec)

mysql> show warnings;
+---------+------+---------------+
| Level   | Code | Message       |
+---------+------+---------------+
| Warning | 1365 | Division by 0 |
+---------+------+---------------+
1 row in set (0.00 sec)

mysql> set session sql_mode='';
Query OK, 0 rows affected (0.00 sec)

mysql> select 4/0;
+------+
| 4/0  |
+------+
| NULL |
+------+
1 row in set (0.00 sec)

mysql> show warnings;
Empty set (0.00 sec)

mysql> show tables;
+-----------------+
| Tables_in_tv_db |
+-----------------+
| Dat             |
| full_review     |
| reviewers       |
| reviews         |
| series          |
+-----------------+
5 rows in set (0.01 sec)

mysql> create table Emp
    -> (
    -> Emp_No tiny_int primary key,
    -> Dapartment Varchar(20) not null,
    -> Salary float not null
    -> );
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'tiny_int primary key, 
Dapartment Varchar(20) not null,
Salary float not null
)' at line 3
mysql> create table Emp(Emp_No tinyint primary key,  Dapartment Varchar(20) not null, Salary float not null );
Query OK, 0 rows affected (0.02 sec)

mysql> desc Emp;
+------------+-------------+------+-----+---------+-------+
| Field      | Type        | Null | Key | Default | Extra |
+------------+-------------+------+-----+---------+-------+
| Emp_No     | tinyint     | NO   | PRI | NULL    |       |
| Dapartment | varchar(20) | NO   |     | NULL    |       |
| Salary     | float       | NO   |     | NULL    |       |
+------------+-------------+------+-----+---------+-------+
3 rows in set (0.00 sec)

mysql> insert into Emp values(1,'Sales',59000.23);
Query OK, 1 row affected (0.00 sec)

mysql> select  * from Emp;
+--------+------------+---------+
| Emp_No | Dapartment | Salary  |
+--------+------------+---------+
|      1 | Sales      | 59000.2 |
+--------+------------+---------+
1 row in set (0.00 sec)

mysql> insert into Emp values(1,'Sales',59000.);
ERROR 1062 (23000): Duplicate entry '1' for key 'emp.PRIMARY'
mysql> select * from emp;
+--------+------------+---------+
| Emp_No | Dapartment | Salary  |
+--------+------------+---------+
|      1 | Sales      | 59000.2 |
+--------+------------+---------+
1 row in set (0.00 sec)

mysql> update emp
    -> set salary=59000;
Query OK, 1 row affected (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select * from emp;
+--------+------------+--------+
| Emp_No | Dapartment | Salary |
+--------+------------+--------+
|      1 | Sales      |  59000 |
+--------+------------+--------+
1 row in set (0.00 sec)

mysql> insert into Emp values(2,'Sales',60000);
Query OK, 1 row affected (0.00 sec)

mysql> select * from emp;
+--------+------------+--------+
| Emp_No | Dapartment | Salary |
+--------+------------+--------+
|      1 | Sales      |  59000 |
|      2 | Sales      |  60000 |
+--------+------------+--------+
2 rows in set (0.00 sec)

mysql> desc emp;
+------------+-------------+------+-----+---------+-------+
| Field      | Type        | Null | Key | Default | Extra |
+------------+-------------+------+-----+---------+-------+
| Emp_No     | tinyint     | NO   | PRI | NULL    |       |
| Dapartment | varchar(20) | NO   |     | NULL    |       |
| Salary     | float       | NO   |     | NULL    |       |
+------------+-------------+------+-----+---------+-------+
3 rows in set (0.01 sec)

mysql> Alter table emp modify Salary mediumint not null;
Query OK, 2 rows affected (0.02 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> desc empo;
ERROR 1146 (42S02): Table 'tv_db.empo' doesn't exist
mysql> desc emp;
+------------+-------------+------+-----+---------+-------+
| Field      | Type        | Null | Key | Default | Extra |
+------------+-------------+------+-----+---------+-------+
| Emp_No     | tinyint     | NO   | PRI | NULL    |       |
| Dapartment | varchar(20) | NO   |     | NULL    |       |
| Salary     | mediumint   | NO   |     | NULL    |       |
+------------+-------------+------+-----+---------+-------+
3 rows in set (0.00 sec)

mysql> insert into Emp values(2,'Sales',60000);
ERROR 1062 (23000): Duplicate entry '2' for key 'emp.PRIMARY'
mysql> select * from emp;
+--------+------------+--------+
| Emp_No | Dapartment | Salary |
+--------+------------+--------+
|      1 | Sales      |  59000 |
|      2 | Sales      |  60000 |
+--------+------------+--------+
2 rows in set (0.00 sec)

mysql> insert into Emp values(3,'Customer',56000);
Query OK, 1 row affected (0.00 sec)

mysql> insert into Emp values(4,'Customer Sevice',55000);
Query OK, 1 row affected (0.01 sec)

mysql> select * from emp;
+--------+-----------------+--------+
| Emp_No | Dapartment      | Salary |
+--------+-----------------+--------+
|      1 | Sales           |  59000 |
|      2 | Sales           |  60000 |
|      3 | Customer        |  56000 |
|      4 | Customer Sevice |  55000 |
+--------+-----------------+--------+
4 rows in set (0.00 sec)

mysql> update emp
    -> set Dapartment='Customer Service' where emp_no=3;
Query OK, 1 row affected (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select * from emp;
+--------+------------------+--------+
| Emp_No | Dapartment       | Salary |
+--------+------------------+--------+
|      1 | Sales            |  59000 |
|      2 | Sales            |  60000 |
|      3 | Customer Service |  56000 |
|      4 | Customer Sevice  |  55000 |
+--------+------------------+--------+
4 rows in set (0.00 sec)

mysql> select dapartment,avg(Salary) from emp group by department;
ERROR 1054 (42S22): Unknown column 'department' in 'group statement'
mysql> select dapartment,avg(Salary) from emp group by department department;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'department' at line 1
mysql> select dapartment,avg(Salary) from emp group by department;
ERROR 1054 (42S22): Unknown column 'department' in 'group statement'
mysql> select dapartment,avg(Salary) from emp group by dapartment;
+------------------+-------------+
| dapartment       | avg(Salary) |
+------------------+-------------+
| Sales            |  59500.0000 |
| Customer Service |  56000.0000 |
| Customer Sevice  |  55000.0000 |
+------------------+-------------+
3 rows in set (0.00 sec)

mysql> update emp
    -> set dapartment='Customer Service' where id=4;
ERROR 1054 (42S22): Unknown column 'id' in 'where clause'
mysql> update emp set dapartment='Customer Service' where emp_no=4;
Query OK, 1 row affected (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select * from emp;
+--------+------------------+--------+
| Emp_No | Dapartment       | Salary |
+--------+------------------+--------+
|      1 | Sales            |  59000 |
|      2 | Sales            |  60000 |
|      3 | Customer Service |  56000 |
|      4 | Customer Service |  55000 |
+--------+------------------+--------+
4 rows in set (0.00 sec)

mysql> aLTER TABLE emp rename Dapartment to Department;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'to Department' at line 1
mysql> aLTER TABLE emp rename column Dapartment to Department;
Query OK, 0 rows affected (0.01 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> desc emp;
+------------+-------------+------+-----+---------+-------+
| Field      | Type        | Null | Key | Default | Extra |
+------------+-------------+------+-----+---------+-------+
| Emp_No     | tinyint     | NO   | PRI | NULL    |       |
| Department | varchar(20) | NO   |     | NULL    |       |
| Salary     | mediumint   | NO   |     | NULL    |       |
+------------+-------------+------+-----+---------+-------+
3 rows in set (0.00 sec)

mysql> select dapartment,avg(Salary) from emp group by department;
ERROR 1054 (42S22): Unknown column 'dapartment' in 'field list'
mysql> select department,avg(Salary) from emp group by department;
+------------------+-------------+
| department       | avg(Salary) |
+------------------+-------------+
| Sales            |  59500.0000 |
| Customer Service |  55500.0000 |
+------------------+-------------+
2 rows in set (0.00 sec)

mysql> select department,max(Salary) from emp group by department;
+------------------+-------------+
| department       | max(Salary) |
+------------------+-------------+
| Sales            |       60000 |
| Customer Service |       56000 |
+------------------+-------------+
2 rows in set (0.00 sec)

mysql> select department,min(Salary) from emp group by department;
+------------------+-------------+
| department       | min(Salary) |
+------------------+-------------+
| Sales            |       59000 |
| Customer Service |       55000 |
+------------------+-------------+
2 rows in set (0.00 sec)

mysql> select department,count(Salary) from emp group by department;
+------------------+---------------+
| department       | count(Salary) |
+------------------+---------------+
| Sales            |             2 |
| Customer Service |             2 |
+------------------+---------------+
2 rows in set (0.00 sec)

mysql> select department,sum(Salary) from emp group by department;
+------------------+-------------+
| department       | sum(Salary) |
+------------------+-------------+
| Sales            |      119000 |
| Customer Service |      111000 |
+------------------+-------------+
2 rows in set (0.00 sec)

mysql> select department,sum(Salary) from emp group by department with rollup;
+------------------+-------------+
| department       | sum(Salary) |
+------------------+-------------+
| Customer Service |      111000 |
| Sales            |      119000 |
| NULL             |      230000 |
+------------------+-------------+
3 rows in set (0.00 sec)

mysql> select department,sum(Salary) from emp group by department having salary>55000;
ERROR 1054 (42S22): Unknown column 'salary' in 'having clause'
mysql> select department,sum(Salary) from emp group by department having department='SALES';
+------------+-------------+
| department | sum(Salary) |
+------------+-------------+
| Sales      |      119000 |
+------------+-------------+
1 row in set (0.00 sec)

mysql> show tables;
+-----------------+
| Tables_in_tv_db |
+-----------------+
| Dat             |
| emp             |
| full_review     |
| reviewers       |
| reviews         |
| series          |
+-----------------+
6 rows in set (0.00 sec)

mysql> select title,Avg(rating),count(rating) as review_count from full_review group by title;
+----------------------+-------------+--------------+
| title                | Avg(rating) | review_count |
+----------------------+-------------+--------------+
| Archer               |     8.12000 |            5 |
| Arrested Development |     8.08000 |            5 |
| Bob's Burgers        |     7.52000 |            5 |
| Bojack Horseman      |     7.94000 |            5 |
| Breaking Bad         |     9.36000 |            5 |
| Curb Your Enthusiasm |     8.12000 |            5 |
| Fargo                |     9.40000 |            2 |
| Freaks and Geeks     |     8.60000 |            4 |
| General Hospital     |     5.38000 |            5 |
| Halt and Catch Fire  |     9.90000 |            1 |
| Seinfeld             |     7.60000 |            2 |
| Stranger Things      |     8.76667 |            3 |
+----------------------+-------------+--------------+
12 rows in set (0.00 sec)

mysql> select title,Avg(rating),count(rating) as review_count from full_review group by title with rollup;;
+----------------------+-------------+--------------+
| title                | Avg(rating) | review_count |
+----------------------+-------------+--------------+
| Archer               |     8.12000 |            5 |
| Arrested Development |     8.08000 |            5 |
| Bob's Burgers        |     7.52000 |            5 |
| Bojack Horseman      |     7.94000 |            5 |
| Breaking Bad         |     9.36000 |            5 |
| Curb Your Enthusiasm |     8.12000 |            5 |
| Fargo                |     9.40000 |            2 |
| Freaks and Geeks     |     8.60000 |            4 |
| General Hospital     |     5.38000 |            5 |
| Halt and Catch Fire  |     9.90000 |            1 |
| Seinfeld             |     7.60000 |            2 |
| Stranger Things      |     8.76667 |            3 |
| NULL                 |     8.02553 |           47 |
+----------------------+-------------+--------------+
13 rows in set (0.00 sec)

ERROR: 
No query specified

mysql> select title,Avg(rating),count(rating) as review_count from full_review group by title with rollup;
+----------------------+-------------+--------------+
| title                | Avg(rating) | review_count |
+----------------------+-------------+--------------+
| Archer               |     8.12000 |            5 |
| Arrested Development |     8.08000 |            5 |
| Bob's Burgers        |     7.52000 |            5 |
| Bojack Horseman      |     7.94000 |            5 |
| Breaking Bad         |     9.36000 |            5 |
| Curb Your Enthusiasm |     8.12000 |            5 |
| Fargo                |     9.40000 |            2 |
| Freaks and Geeks     |     8.60000 |            4 |
| General Hospital     |     5.38000 |            5 |
| Halt and Catch Fire  |     9.90000 |            1 |
| Seinfeld             |     7.60000 |            2 |
| Stranger Things      |     8.76667 |            3 |
| NULL                 |     8.02553 |           47 |
+----------------------+-------------+--------------+
13 rows in set (0.00 sec)

mysql> select title,Avg(rating),count(rating) as review_count from full_review group by title having review_count>3;
+----------------------+-------------+--------------+
| title                | Avg(rating) | review_count |
+----------------------+-------------+--------------+
| Archer               |     8.12000 |            5 |
| Arrested Development |     8.08000 |            5 |
| Bob's Burgers        |     7.52000 |            5 |
| Bojack Horseman      |     7.94000 |            5 |
| Breaking Bad         |     9.36000 |            5 |
| Curb Your Enthusiasm |     8.12000 |            5 |
| Freaks and Geeks     |     8.60000 |            4 |
| General Hospital     |     5.38000 |            5 |
+----------------------+-------------+--------------+
8 rows in set (0.00 sec)

mysql> show views;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'views' at line 1
mysql> show  create views;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'views' at line 1
mysql> show  create views full_review;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'views full_review' at line 1
mysql> show  create view full_review;
+-------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+
| View        | Create View                                                                                                                                                                                                                                                                                                                                                                                                                                                               | character_set_client | collation_connection |
+-------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+
| full_review | CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `full_review` AS select `series`.`title` AS `title`,`series`.`released_year` AS `released_year`,`series`.`genre` AS `genre`,`reviews`.`rating` AS `rating`,`reviewers`.`first_name` AS `first_name`,`reviewers`.`last_name` AS `last_Name` from ((`reviews` join `series` on((`reviews`.`series_id` = `series`.`id`))) join `reviewers` on((`reviewers`.`id` = `reviews`.`reviewer_id`))) | utf8mb4              | utf8mb4_0900_ai_ci   |
+-------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+
1 row in set (0.01 sec)

mysql> show tables;
+-----------------+
| Tables_in_tv_db |
+-----------------+
| Dat             |
| emp             |
| full_review     |
| reviewers       |
| reviews         |
| series          |
+-----------------+
6 rows in set (0.00 sec)

mysql> desc dat;
+-------+------+------+-----+---------+-------+
| Field | Type | Null | Key | Default | Extra |
+-------+------+------+-----+---------+-------+
| Dta   | date | YES  |     | NULL    |       |
+-------+------+------+-----+---------+-------+
1 row in set (0.01 sec)

mysql> desc emp;
+------------+-------------+------+-----+---------+-------+
| Field      | Type        | Null | Key | Default | Extra |
+------------+-------------+------+-----+---------+-------+
| Emp_No     | tinyint     | NO   | PRI | NULL    |       |
| Department | varchar(20) | NO   |     | NULL    |       |
| Salary     | mediumint   | NO   |     | NULL    |       |
+------------+-------------+------+-----+---------+-------+
3 rows in set (0.00 sec)

mysql> -- Create view name as select first_Name,last_Name from series;
mysql>  Create view name as select first_Name,last_Name from series;
ERROR 1054 (42S22): Unknown column 'first_Name' in 'field list'
mysql> desc series;
+---------------+--------------+------+-----+---------+----------------+
| Field         | Type         | Null | Key | Default | Extra          |
+---------------+--------------+------+-----+---------+----------------+
| id            | int          | NO   | PRI | NULL    | auto_increment |
| title         | varchar(100) | YES  |     | NULL    |                |
| released_year | year         | YES  |     | NULL    |                |
| genre         | varchar(100) | YES  |     | NULL    |                |
+---------------+--------------+------+-----+---------+----------------+
4 rows in set (0.00 sec)

mysql> select * from series;
+----+-----------------------+---------------+-----------+
| id | title                 | released_year | genre     |
+----+-----------------------+---------------+-----------+
|  1 | Archer                |          2009 | Animation |
|  2 | Arrested Development  |          2003 | Comedy    |
|  3 | Bob's Burgers         |          2011 | Animation |
|  4 | Bojack Horseman       |          2014 | Animation |
|  5 | Breaking Bad          |          2008 | Drama     |
|  6 | Curb Your Enthusiasm  |          2000 | Comedy    |
|  7 | Fargo                 |          2014 | Drama     |
|  8 | Freaks and Geeks      |          1999 | Comedy    |
|  9 | General Hospital      |          1963 | Drama     |
| 10 | Halt and Catch Fire   |          2014 | Drama     |
| 11 | Malcolm In The Middle |          2000 | Comedy    |
| 12 | Pushing Daisies       |          2007 | Comedy    |
| 13 | Seinfeld              |          1989 | Comedy    |
| 14 | Stranger Things       |          2016 | Drama     |
+----+-----------------------+---------------+-----------+
14 rows in set (0.00 sec)

mysql> select * from reviewers;
+----+------------+-----------+
| id | first_name | last_name |
+----+------------+-----------+
|  1 | Thomas     | Stoneman  |
|  2 | Wyatt      | Skaggs    |
|  3 | Kimbra     | Masters   |
|  4 | Domingo    | Cortes    |
|  5 | Colt       | Steele    |
|  6 | Pinkie     | Petit     |
|  7 | Marlon     | Crafford  |
+----+------------+-----------+
7 rows in set (0.00 sec)

mysql> create view Name as select first_Name,Last_Name from Reviewers;
Query OK, 0 rows affected (0.01 sec)

mysql> show tables;
+-----------------+
| Tables_in_tv_db |
+-----------------+
| Dat             |
| emp             |
| full_review     |
| name            |
| reviewers       |
| reviews         |
| series          |
+-----------------+
7 rows in set (0.00 sec)

mysql> desc name;
+------------+-------------+------+-----+---------+-------+
| Field      | Type        | Null | Key | Default | Extra |
+------------+-------------+------+-----+---------+-------+
| first_Name | varchar(50) | NO   |     | NULL    |       |
| Last_Name  | varchar(50) | NO   |     | NULL    |       |
+------------+-------------+------+-----+---------+-------+
2 rows in set (0.00 sec)

mysql> select * from name;
+------------+-----------+
| first_Name | Last_Name |
+------------+-----------+
| Thomas     | Stoneman  |
| Wyatt      | Skaggs    |
| Kimbra     | Masters   |
| Domingo    | Cortes    |
| Colt       | Steele    |
| Pinkie     | Petit     |
| Marlon     | Crafford  |
+------------+-----------+
7 rows in set (0.00 sec)

mysql> -- Alter the view with altewr command
mysql> Alter view Name as select id,First_name,Last_Name from reviewers;
Query OK, 0 rows affected (0.00 sec)

mysql> show tables;
+-----------------+
| Tables_in_tv_db |
+-----------------+
| Dat             |
| emp             |
| full_review     |
| name            |
| reviewers       |
| reviews         |
| series          |
+-----------------+
7 rows in set (0.00 sec)

mysql> desc name;
+------------+-------------+------+-----+---------+-------+
| Field      | Type        | Null | Key | Default | Extra |
+------------+-------------+------+-----+---------+-------+
| id         | int         | NO   |     | 0       |       |
| First_name | varchar(50) | NO   |     | NULL    |       |
| Last_Name  | varchar(50) | NO   |     | NULL    |       |
+------------+-------------+------+-----+---------+-------+
3 rows in set (0.00 sec)

mysql> select * from name;
+----+------------+-----------+
| id | First_name | Last_Name |
+----+------------+-----------+
|  1 | Thomas     | Stoneman  |
|  2 | Wyatt      | Skaggs    |
|  3 | Kimbra     | Masters   |
|  4 | Domingo    | Cortes    |
|  5 | Colt       | Steele    |
|  6 | Pinkie     | Petit     |
|  7 | Marlon     | Crafford  |
+----+------------+-----------+
7 rows in set (0.00 sec)

mysql> drop view Name;
Query OK, 0 rows affected (0.01 sec)

mysql> show tables;
+-----------------+
| Tables_in_tv_db |
+-----------------+
| Dat             |
| emp             |
| full_review     |
| reviewers       |
| reviews         |
| series          |
+-----------------+
6 rows in set (0.00 sec)

mysql> select * from name;
ERROR 1146 (42S02): Table 'tv_db.name' doesn't exist
mysql> create view Name as select first_Name,Last_Name from Reviewers;
Query OK, 0 rows affected (0.01 sec)

mysql> show tables;
+-----------------+
| Tables_in_tv_db |
+-----------------+
| Dat             |
| emp             |
| full_review     |
| name            |
| reviewers       |
| reviews         |
| series          |
+-----------------+
7 rows in set (0.00 sec)

mysql> select * from name;
+------------+-----------+
| first_Name | Last_Name |
+------------+-----------+
| Thomas     | Stoneman  |
| Wyatt      | Skaggs    |
| Kimbra     | Masters   |
| Domingo    | Cortes    |
| Colt       | Steele    |
| Pinkie     | Petit     |
| Marlon     | Crafford  |
+------------+-----------+
7 rows in set (0.01 sec)

mysql> create or replace view name as select * from reviewers;
Query OK, 0 rows affected (0.00 sec)

mysql> show tables;
+-----------------+
| Tables_in_tv_db |
+-----------------+
| Dat             |
| emp             |
| full_review     |
| name            |
| reviewers       |
| reviews         |
| series          |
+-----------------+
7 rows in set (0.00 sec)

mysql> desc name;
+------------+-------------+------+-----+---------+-------+
| Field      | Type        | Null | Key | Default | Extra |
+------------+-------------+------+-----+---------+-------+
| id         | int         | NO   |     | 0       |       |
| first_name | varchar(50) | NO   |     | NULL    |       |
| last_name  | varchar(50) | NO   |     | NULL    |       |
+------------+-------------+------+-----+---------+-------+
3 rows in set (0.00 sec)

mysql> select * from name;
+----+------------+-----------+
| id | first_name | last_name |
+----+------------+-----------+
|  1 | Thomas     | Stoneman  |
|  2 | Wyatt      | Skaggs    |
|  3 | Kimbra     | Masters   |
|  4 | Domingo    | Cortes    |
|  5 | Colt       | Steele    |
|  6 | Pinkie     | Petit     |
|  7 | Marlon     | Crafford  |
+----+------------+-----------+
7 rows in set (0.00 sec)

mysql> show tables;
+-----------------+
| Tables_in_tv_db |
+-----------------+
| Dat             |
| emp             |
| full_review     |
| name            |
| reviewers       |
| reviews         |
| series          |
+-----------------+
7 rows in set (0.00 sec)

mysql> select * from full_review;
+----------------------+---------------+-----------+--------+------------+-----------+
| title                | released_year | genre     | rating | first_name | last_Name |
+----------------------+---------------+-----------+--------+------------+-----------+
| Archer               |          2009 | Animation |    8.0 | Thomas     | Stoneman  |
| Arrested Development |          2003 | Comedy    |    8.1 | Thomas     | Stoneman  |
| Bob's Burgers        |          2011 | Animation |    7.0 | Thomas     | Stoneman  |
| Bojack Horseman      |          2014 | Animation |    7.5 | Thomas     | Stoneman  |
| Breaking Bad         |          2008 | Drama     |    9.5 | Thomas     | Stoneman  |
| Archer               |          2009 | Animation |    7.5 | Wyatt      | Skaggs    |
| Bojack Horseman      |          2014 | Animation |    7.6 | Wyatt      | Skaggs    |
| Breaking Bad         |          2008 | Drama     |    9.3 | Wyatt      | Skaggs    |
| Curb Your Enthusiasm |          2000 | Comedy    |    6.5 | Wyatt      | Skaggs    |
| Curb Your Enthusiasm |          2000 | Comedy    |    8.4 | Wyatt      | Skaggs    |
| Fargo                |          2014 | Drama     |    9.1 | Wyatt      | Skaggs    |
| Freaks and Geeks     |          1999 | Comedy    |    7.8 | Wyatt      | Skaggs    |
| General Hospital     |          1963 | Drama     |    5.5 | Wyatt      | Skaggs    |
| Stranger Things      |          2016 | Drama     |    8.5 | Wyatt      | Skaggs    |
| Archer               |          2009 | Animation |    8.5 | Kimbra     | Masters   |
| Arrested Development |          2003 | Comedy    |    8.0 | Kimbra     | Masters   |
| Bob's Burgers        |          2011 | Animation |    7.1 | Kimbra     | Masters   |
| Bojack Horseman      |          2014 | Animation |    7.8 | Kimbra     | Masters   |
| Breaking Bad         |          2008 | Drama     |    9.0 | Kimbra     | Masters   |
| Curb Your Enthusiasm |          2000 | Comedy    |    7.8 | Kimbra     | Masters   |
| General Hospital     |          1963 | Drama     |    6.8 | Kimbra     | Masters   |
| Seinfeld             |          1989 | Comedy    |    8.0 | Kimbra     | Masters   |
| Stranger Things      |          2016 | Drama     |    8.9 | Kimbra     | Masters   |
| Archer               |          2009 | Animation |    7.7 | Domingo    | Cortes    |
| Arrested Development |          2003 | Comedy    |    6.0 | Domingo    | Cortes    |
| Bob's Burgers        |          2011 | Animation |    8.0 | Domingo    | Cortes    |
| Bojack Horseman      |          2014 | Animation |    8.3 | Domingo    | Cortes    |
| Breaking Bad         |          2008 | Drama     |    9.1 | Domingo    | Cortes    |
| Curb Your Enthusiasm |          2000 | Comedy    |    8.8 | Domingo    | Cortes    |
| Freaks and Geeks     |          1999 | Comedy    |    8.5 | Domingo    | Cortes    |
| General Hospital     |          1963 | Drama     |    5.8 | Domingo    | Cortes    |
| Seinfeld             |          1989 | Comedy    |    7.2 | Domingo    | Cortes    |
| Stranger Things      |          2016 | Drama     |    8.9 | Domingo    | Cortes    |
| Archer               |          2009 | Animation |    8.9 | Colt       | Steele    |
| Arrested Development |          2003 | Comedy    |    9.9 | Colt       | Steele    |
| Bob's Burgers        |          2011 | Animation |    8.0 | Colt       | Steele    |
| Bojack Horseman      |          2014 | Animation |    8.5 | Colt       | Steele    |
| Breaking Bad         |          2008 | Drama     |    9.9 | Colt       | Steele    |
| Curb Your Enthusiasm |          2000 | Comedy    |    9.1 | Colt       | Steele    |
| Fargo                |          2014 | Drama     |    9.7 | Colt       | Steele    |
| Freaks and Geeks     |          1999 | Comedy    |    9.3 | Colt       | Steele    |
| General Hospital     |          1963 | Drama     |    4.5 | Colt       | Steele    |
| Halt and Catch Fire  |          2014 | Drama     |    9.9 | Colt       | Steele    |
| Arrested Development |          2003 | Comedy    |    8.4 | Pinkie     | Petit     |
| Bob's Burgers        |          2011 | Animation |    7.5 | Pinkie     | Petit     |
| Freaks and Geeks     |          1999 | Comedy    |    8.8 | Pinkie     | Petit     |
| General Hospital     |          1963 | Drama     |    4.3 | Pinkie     | Petit     |
+----------------------+---------------+-----------+--------+------------+-----------+
47 rows in set (0.00 sec)

mysql> show create view full_review;
+-------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+
| View        | Create View                                                                                                                                                                                                                                                                                                                                                                                                                                                               | character_set_client | collation_connection |
+-------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+
| full_review | CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `full_review` AS select `series`.`title` AS `title`,`series`.`released_year` AS `released_year`,`series`.`genre` AS `genre`,`reviews`.`rating` AS `rating`,`reviewers`.`first_name` AS `first_name`,`reviewers`.`last_name` AS `last_Name` from ((`reviews` join `series` on((`reviews`.`series_id` = `series`.`id`))) join `reviewers` on((`reviewers`.`id` = `reviews`.`reviewer_id`))) | utf8mb4              | utf8mb4_0900_ai_ci   |
+-------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+
1 row in set (0.00 sec)

mysql> -- It contain Join in view so its not updatable 
mysql> Alter view full_review as Select * from reviews;
Query OK, 0 rows affected (0.00 sec)

mysql> show tables;
+-----------------+
| Tables_in_tv_db |
+-----------------+
| Dat             |
| emp             |
| full_review     |
| name            |
| reviewers       |
| reviews         |
| series          |
+-----------------+
7 rows in set (0.00 sec)

mysql> select * from full_review;
+----+--------+-----------+-------------+
| id | rating | series_id | reviewer_id |
+----+--------+-----------+-------------+
|  1 |    8.0 |         1 |           1 |
|  2 |    7.5 |         1 |           2 |
|  3 |    8.5 |         1 |           3 |
|  4 |    7.7 |         1 |           4 |
|  5 |    8.9 |         1 |           5 |
|  6 |    8.1 |         2 |           1 |
|  7 |    6.0 |         2 |           4 |
|  8 |    8.0 |         2 |           3 |
|  9 |    8.4 |         2 |           6 |
| 10 |    9.9 |         2 |           5 |
| 11 |    7.0 |         3 |           1 |
| 12 |    7.5 |         3 |           6 |
| 13 |    8.0 |         3 |           4 |
| 14 |    7.1 |         3 |           3 |
| 15 |    8.0 |         3 |           5 |
| 16 |    7.5 |         4 |           1 |
| 17 |    7.8 |         4 |           3 |
| 18 |    8.3 |         4 |           4 |
| 19 |    7.6 |         4 |           2 |
| 20 |    8.5 |         4 |           5 |
| 21 |    9.5 |         5 |           1 |
| 22 |    9.0 |         5 |           3 |
| 23 |    9.1 |         5 |           4 |
| 24 |    9.3 |         5 |           2 |
| 25 |    9.9 |         5 |           5 |
| 26 |    6.5 |         6 |           2 |
| 27 |    7.8 |         6 |           3 |
| 28 |    8.8 |         6 |           4 |
| 29 |    8.4 |         6 |           2 |
| 30 |    9.1 |         6 |           5 |
| 31 |    9.1 |         7 |           2 |
| 32 |    9.7 |         7 |           5 |
| 33 |    8.5 |         8 |           4 |
| 34 |    7.8 |         8 |           2 |
| 35 |    8.8 |         8 |           6 |
| 36 |    9.3 |         8 |           5 |
| 37 |    5.5 |         9 |           2 |
| 38 |    6.8 |         9 |           3 |
| 39 |    5.8 |         9 |           4 |
| 40 |    4.3 |         9 |           6 |
| 41 |    4.5 |         9 |           5 |
| 42 |    9.9 |        10 |           5 |
| 43 |    8.0 |        13 |           3 |
| 44 |    7.2 |        13 |           4 |
| 45 |    8.5 |        14 |           2 |
| 46 |    8.9 |        14 |           3 |
| 47 |    8.9 |        14 |           4 |
| 48 |    0.0 |      NULL |        NULL |
| 49 |    0.0 |      NULL |        NULL |
+----+--------+-----------+-------------+
49 rows in set (0.00 sec)

mysql> show tables;
+-----------------+
| Tables_in_tv_db |
+-----------------+
| Dat             |
| emp             |
| full_review     |
| name            |
| reviewers       |
| reviews         |
| series          |
+-----------------+
7 rows in set (0.00 sec)

mysql> desc emp;
+------------+-------------+------+-----+---------+-------+
| Field      | Type        | Null | Key | Default | Extra |
+------------+-------------+------+-----+---------+-------+
| Emp_No     | tinyint     | NO   | PRI | NULL    |       |
| Department | varchar(20) | NO   |     | NULL    |       |
| Salary     | mediumint   | NO   |     | NULL    |       |
+------------+-------------+------+-----+---------+-------+
3 rows in set (0.00 sec)

mysql> select * from emp;
+--------+------------------+--------+
| Emp_No | Department       | Salary |
+--------+------------------+--------+
|      1 | Sales            |  59000 |
|      2 | Sales            |  60000 |
|      3 | Customer Service |  56000 |
|      4 | Customer Service |  55000 |
+--------+------------------+--------+
4 rows in set (0.00 sec)

mysql> select department,Avg(Salary) from emp group by Department ;
+------------------+-------------+
| department       | Avg(Salary) |
+------------------+-------------+
| Sales            |  59500.0000 |
| Customer Service |  55500.0000 |
+------------------+-------------+
2 rows in set (0.00 sec)

mysql> select department,Avg(Salary) from emp group by Department with rollup ;
+------------------+-------------+
| department       | Avg(Salary) |
+------------------+-------------+
| Customer Service |  55500.0000 |
| Sales            |  59500.0000 |
| NULL             |  57500.0000 |
+------------------+-------------+
3 rows in set (0.00 sec)

mysql> select department,count(Salary) from emp group by Department with rollup ;
+------------------+---------------+
| department       | count(Salary) |
+------------------+---------------+
| Customer Service |             2 |
| Sales            |             2 |
| NULL             |             4 |
+------------------+---------------+
3 rows in set (0.00 sec)

mysql> show tables;
+-----------------+
| Tables_in_tv_db |
+-----------------+
| Dat             |
| emp             |
| full_review     |
| name            |
| reviewers       |
| reviews         |
| series          |
+-----------------+
7 rows in set (0.00 sec)

mysql> desc emp;
+------------+-------------+------+-----+---------+-------+
| Field      | Type        | Null | Key | Default | Extra |
+------------+-------------+------+-----+---------+-------+
| Emp_No     | tinyint     | NO   | PRI | NULL    |       |
| Department | varchar(20) | NO   |     | NULL    |       |
| Salary     | mediumint   | NO   |     | NULL    |       |
+------------+-------------+------+-----+---------+-------+
3 rows in set (0.01 sec)

mysql> select * from emp;
+--------+------------------+--------+
| Emp_No | Department       | Salary |
+--------+------------------+--------+
|      1 | Sales            |  59000 |
|      2 | Sales            |  60000 |
|      3 | Customer Service |  56000 |
|      4 | Customer Service |  55000 |
+--------+------------------+--------+
4 rows in set (0.00 sec)

mysql> select emp_no,department,Salary,Avg(Salary) over(Partition by department) as Dept_Avg from emp;
+--------+------------------+--------+------------+
| emp_no | department       | Salary | Dept_Avg   |
+--------+------------------+--------+------------+
|      3 | Customer Service |  56000 | 55500.0000 |
|      4 | Customer Service |  55000 | 55500.0000 |
|      1 | Sales            |  59000 | 59500.0000 |
|      2 | Sales            |  60000 | 59500.0000 |
+--------+------------------+--------+------------+
4 rows in set (0.00 sec)

mysql> -- Windows function 
mysql> select emp_no,department,Salary,Avg(Salary) over(Partition by department) as Dept_Avg from emp;
+--------+------------------+--------+------------+
| emp_no | department       | Salary | Dept_Avg   |
+--------+------------------+--------+------------+
|      3 | Customer Service |  56000 | 55500.0000 |
|      4 | Customer Service |  55000 | 55500.0000 |
|      1 | Sales            |  59000 | 59500.0000 |
|      2 | Sales            |  60000 | 59500.0000 |
+--------+------------------+--------+------------+
4 rows in set (0.00 sec)

mysql> show databases;
+----------------------+
| Database             |
+----------------------+
| ABES                 |
| Aggregate            |
| bankmanagementsystem |
| Books                |
| BookShop             |
| constraints          |
| DBMS                 |
| information_schema   |
| mysql                |
| performance_schema   |
| Practice             |
| RadheKrishna         |
| Shirt                |
| Student              |
| sys                  |
| Triggers             |
| Tv_db                |
| View                 |
+----------------------+
18 rows in set (0.00 sec)

mysql> create database windowfunc;
Query OK, 1 row affected (0.00 sec)

mysql> show schemas;
+----------------------+
| Database             |
+----------------------+
| ABES                 |
| Aggregate            |
| bankmanagementsystem |
| Books                |
| BookShop             |
| constraints          |
| DBMS                 |
| information_schema   |
| mysql                |
| performance_schema   |
| Practice             |
| RadheKrishna         |
| Shirt                |
| Student              |
| sys                  |
| Triggers             |
| Tv_db                |
| View                 |
| windowfunc           |
+----------------------+
19 rows in set (0.00 sec)

mysql> connect windowfunc;
Connection id:    12
Current database: windowfunc

mysql> show tables;
Empty set (0.01 sec)

mysql> CREATE TABLE employees (
    ->     emp_no INT PRIMARY KEY AUTO_INCREMENT,
    ->     department VARCHAR(20),
    ->     salary INT
    -> );
Query OK, 0 rows affected (0.01 sec)

mysql> show tables;
+----------------------+
| Tables_in_windowfunc |
+----------------------+
| employees            |
+----------------------+
1 row in set (0.00 sec)

mysql> desc employees;
+------------+-------------+------+-----+---------+----------------+
| Field      | Type        | Null | Key | Default | Extra          |
+------------+-------------+------+-----+---------+----------------+
| emp_no     | int         | NO   | PRI | NULL    | auto_increment |
| department | varchar(20) | YES  |     | NULL    |                |
| salary     | int         | YES  |     | NULL    |                |
+------------+-------------+------+-----+---------+----------------+
3 rows in set (0.01 sec)

mysql> select * from employees;
Empty set (0.01 sec)

mysql> INSERT INTO employees (department, salary) VALUES
    -> ('engineering', 80000),
    -> ('engineering', 69000),
    -> ('engineering', 70000),
    -> ('engineering', 103000),
    -> ('engineering', 67000),
    -> ('engineering', 89000),
    -> ('engineering', 91000),
    -> ('sales', 59000),
    -> ('sales', 70000),
    -> ('sales', 159000),
    -> ('sales', 72000),
    -> ('sales', 60000),
    -> ('sales', 61000),
    -> ('sales', 61000),
    -> ('customer service', 38000),
    -> ('customer service', 45000),
    -> ('customer service', 61000),
    -> ('customer service', 40000),
    -> ('customer service', 31000),
    -> ('customer service', 56000),
    -> ('customer service', 55000);
Query OK, 21 rows affected (0.00 sec)
Records: 21  Duplicates: 0  Warnings: 0

mysql> select * from employees;
+--------+------------------+--------+
| emp_no | department       | salary |
+--------+------------------+--------+
|      1 | engineering      |  80000 |
|      2 | engineering      |  69000 |
|      3 | engineering      |  70000 |
|      4 | engineering      | 103000 |
|      5 | engineering      |  67000 |
|      6 | engineering      |  89000 |
|      7 | engineering      |  91000 |
|      8 | sales            |  59000 |
|      9 | sales            |  70000 |
|     10 | sales            | 159000 |
|     11 | sales            |  72000 |
|     12 | sales            |  60000 |
|     13 | sales            |  61000 |
|     14 | sales            |  61000 |
|     15 | customer service |  38000 |
|     16 | customer service |  45000 |
|     17 | customer service |  61000 |
|     18 | customer service |  40000 |
|     19 | customer service |  31000 |
|     20 | customer service |  56000 |
|     21 | customer service |  55000 |
+--------+------------------+--------+
21 rows in set (0.00 sec)

mysql> select database();
+------------+
| database() |
+------------+
| windowfunc |
+------------+
1 row in set (0.00 sec)

mysql> desc employees;
+------------+-------------+------+-----+---------+----------------+
| Field      | Type        | Null | Key | Default | Extra          |
+------------+-------------+------+-----+---------+----------------+
| emp_no     | int         | NO   | PRI | NULL    | auto_increment |
| department | varchar(20) | YES  |     | NULL    |                |
| salary     | int         | YES  |     | NULL    |                |
+------------+-------------+------+-----+---------+----------------+
3 rows in set (0.01 sec)

mysql> select department,Avg(Salary) from employees group by department;
+------------------+-------------+
| department       | Avg(Salary) |
+------------------+-------------+
| engineering      |  81285.7143 |
| sales            |  77428.5714 |
| customer service |  46571.4286 |
+------------------+-------------+
3 rows in set (0.00 sec)

mysql> select department,count(*) from employees group by department;
+------------------+----------+
| department       | count(*) |
+------------------+----------+
| engineering      |        7 |
| sales            |        7 |
| customer service |        7 |
+------------------+----------+
3 rows in set (0.00 sec)

mysql> select * from employees where Department='Engineering';
+--------+-------------+--------+
| emp_no | department  | salary |
+--------+-------------+--------+
|      1 | engineering |  80000 |
|      2 | engineering |  69000 |
|      3 | engineering |  70000 |
|      4 | engineering | 103000 |
|      5 | engineering |  67000 |
|      6 | engineering |  89000 |
|      7 | engineering |  91000 |
+--------+-------------+--------+
7 rows in set (0.00 sec)

mysql> select department,Avg(Salary) from employees where Department='Engineering' group by Department;
+-------------+-------------+
| department  | Avg(Salary) |
+-------------+-------------+
| engineering |  81285.7143 |
+-------------+-------------+
1 row in set (0.00 sec)

mysql> select department,Avg(Salary) from employees where department In('Engineering','Sales') group by Department;
+-------------+-------------+
| department  | Avg(Salary) |
+-------------+-------------+
| engineering |  81285.7143 |
| sales       |  77428.5714 |
+-------------+-------------+
2 rows in set (0.00 sec)

mysql> select department,Avg(Salary) from employees where department not  In('Engineering','Sales') group by Department
;
+------------------+-------------+
| department       | Avg(Salary) |
+------------------+-------------+
| customer service |  46571.4286 |
+------------------+-------------+
1 row in set (0.00 sec)

mysql> select avg(Salary) from employees;
+-------------+
| avg(Salary) |
+-------------+
|  68428.5714 |
+-------------+
1 row in set (0.00 sec)

mysql> select avg(Salary) over() from employees;
+--------------------+
| avg(Salary) over() |
+--------------------+
|         68428.5714 |
|         68428.5714 |
|         68428.5714 |
|         68428.5714 |
|         68428.5714 |
|         68428.5714 |
|         68428.5714 |
|         68428.5714 |
|         68428.5714 |
|         68428.5714 |
|         68428.5714 |
|         68428.5714 |
|         68428.5714 |
|         68428.5714 |
|         68428.5714 |
|         68428.5714 |
|         68428.5714 |
|         68428.5714 |
|         68428.5714 |
|         68428.5714 |
|         68428.5714 |
+--------------------+
21 rows in set (0.00 sec)

mysql> select emp_no,department,Salary,avg(Salary) over() from employees;
+--------+------------------+--------+--------------------+
| emp_no | department       | Salary | avg(Salary) over() |
+--------+------------------+--------+--------------------+
|      1 | engineering      |  80000 |         68428.5714 |
|      2 | engineering      |  69000 |         68428.5714 |
|      3 | engineering      |  70000 |         68428.5714 |
|      4 | engineering      | 103000 |         68428.5714 |
|      5 | engineering      |  67000 |         68428.5714 |
|      6 | engineering      |  89000 |         68428.5714 |
|      7 | engineering      |  91000 |         68428.5714 |
|      8 | sales            |  59000 |         68428.5714 |
|      9 | sales            |  70000 |         68428.5714 |
|     10 | sales            | 159000 |         68428.5714 |
|     11 | sales            |  72000 |         68428.5714 |
|     12 | sales            |  60000 |         68428.5714 |
|     13 | sales            |  61000 |         68428.5714 |
|     14 | sales            |  61000 |         68428.5714 |
|     15 | customer service |  38000 |         68428.5714 |
|     16 | customer service |  45000 |         68428.5714 |
|     17 | customer service |  61000 |         68428.5714 |
|     18 | customer service |  40000 |         68428.5714 |
|     19 | customer service |  31000 |         68428.5714 |
|     20 | customer service |  56000 |         68428.5714 |
|     21 | customer service |  55000 |         68428.5714 |
+--------+------------------+--------+--------------------+
21 rows in set (0.00 sec)

mysql> select emp_no,department,Salary,avg(Salary) over(partition by department) from employees;
+--------+------------------+--------+-------------------------------------------+
| emp_no | department       | Salary | avg(Salary) over(partition by department) |
+--------+------------------+--------+-------------------------------------------+
|     15 | customer service |  38000 |                                46571.4286 |
|     16 | customer service |  45000 |                                46571.4286 |
|     17 | customer service |  61000 |                                46571.4286 |
|     18 | customer service |  40000 |                                46571.4286 |
|     19 | customer service |  31000 |                                46571.4286 |
|     20 | customer service |  56000 |                                46571.4286 |
|     21 | customer service |  55000 |                                46571.4286 |
|      1 | engineering      |  80000 |                                81285.7143 |
|      2 | engineering      |  69000 |                                81285.7143 |
|      3 | engineering      |  70000 |                                81285.7143 |
|      4 | engineering      | 103000 |                                81285.7143 |
|      5 | engineering      |  67000 |                                81285.7143 |
|      6 | engineering      |  89000 |                                81285.7143 |
|      7 | engineering      |  91000 |                                81285.7143 |
|      8 | sales            |  59000 |                                77428.5714 |
|      9 | sales            |  70000 |                                77428.5714 |
|     10 | sales            | 159000 |                                77428.5714 |
|     11 | sales            |  72000 |                                77428.5714 |
|     12 | sales            |  60000 |                                77428.5714 |
|     13 | sales            |  61000 |                                77428.5714 |
|     14 | sales            |  61000 |                                77428.5714 |
+--------+------------------+--------+-------------------------------------------+
21 rows in set (0.00 sec)

mysql> select emp_no,department,salary,Min(Salary) over() as Minimum_Salary,Max(Salary) over() as Maximum_Salary from employees;
+--------+------------------+--------+----------------+----------------+
| emp_no | department       | salary | Minimum_Salary | Maximum_Salary |
+--------+------------------+--------+----------------+----------------+
|      1 | engineering      |  80000 |          31000 |         159000 |
|      2 | engineering      |  69000 |          31000 |         159000 |
|      3 | engineering      |  70000 |          31000 |         159000 |
|      4 | engineering      | 103000 |          31000 |         159000 |
|      5 | engineering      |  67000 |          31000 |         159000 |
|      6 | engineering      |  89000 |          31000 |         159000 |
|      7 | engineering      |  91000 |          31000 |         159000 |
|      8 | sales            |  59000 |          31000 |         159000 |
|      9 | sales            |  70000 |          31000 |         159000 |
|     10 | sales            | 159000 |          31000 |         159000 |
|     11 | sales            |  72000 |          31000 |         159000 |
|     12 | sales            |  60000 |          31000 |         159000 |
|     13 | sales            |  61000 |          31000 |         159000 |
|     14 | sales            |  61000 |          31000 |         159000 |
|     15 | customer service |  38000 |          31000 |         159000 |
|     16 | customer service |  45000 |          31000 |         159000 |
|     17 | customer service |  61000 |          31000 |         159000 |
|     18 | customer service |  40000 |          31000 |         159000 |
|     19 | customer service |  31000 |          31000 |         159000 |
|     20 | customer service |  56000 |          31000 |         159000 |
|     21 | customer service |  55000 |          31000 |         159000 |
+--------+------------------+--------+----------------+----------------+
21 rows in set (0.00 sec)

mysql> select * from employees;
+--------+------------------+--------+
| emp_no | department       | salary |
+--------+------------------+--------+
|      1 | engineering      |  80000 |
|      2 | engineering      |  69000 |
|      3 | engineering      |  70000 |
|      4 | engineering      | 103000 |
|      5 | engineering      |  67000 |
|      6 | engineering      |  89000 |
|      7 | engineering      |  91000 |
|      8 | sales            |  59000 |
|      9 | sales            |  70000 |
|     10 | sales            | 159000 |
|     11 | sales            |  72000 |
|     12 | sales            |  60000 |
|     13 | sales            |  61000 |
|     14 | sales            |  61000 |
|     15 | customer service |  38000 |
|     16 | customer service |  45000 |
|     17 | customer service |  61000 |
|     18 | customer service |  40000 |
|     19 | customer service |  31000 |
|     20 | customer service |  56000 |
|     21 | customer service |  55000 |
+--------+------------------+--------+
21 rows in set (0.00 sec)

mysql> select emp_no,department,salary,Min(Salary) over(Partition by department) as Minimum_Salary,Max(Salary) over(par
tition by department) as Maximum_Salary from employees;
+--------+------------------+--------+----------------+----------------+
| emp_no | department       | salary | Minimum_Salary | Maximum_Salary |
+--------+------------------+--------+----------------+----------------+
|     15 | customer service |  38000 |          31000 |          61000 |
|     16 | customer service |  45000 |          31000 |          61000 |
|     17 | customer service |  61000 |          31000 |          61000 |
|     18 | customer service |  40000 |          31000 |          61000 |
|     19 | customer service |  31000 |          31000 |          61000 |
|     20 | customer service |  56000 |          31000 |          61000 |
|     21 | customer service |  55000 |          31000 |          61000 |
|      1 | engineering      |  80000 |          67000 |         103000 |
|      2 | engineering      |  69000 |          67000 |         103000 |
|      3 | engineering      |  70000 |          67000 |         103000 |
|      4 | engineering      | 103000 |          67000 |         103000 |
|      5 | engineering      |  67000 |          67000 |         103000 |
|      6 | engineering      |  89000 |          67000 |         103000 |
|      7 | engineering      |  91000 |          67000 |         103000 |
|      8 | sales            |  59000 |          59000 |         159000 |
|      9 | sales            |  70000 |          59000 |         159000 |
|     10 | sales            | 159000 |          59000 |         159000 |
|     11 | sales            |  72000 |          59000 |         159000 |
|     12 | sales            |  60000 |          59000 |         159000 |
|     13 | sales            |  61000 |          59000 |         159000 |
|     14 | sales            |  61000 |          59000 |         159000 |
+--------+------------------+--------+----------------+----------------+
21 rows in set (0.00 sec)

mysql> 
  [Restored 14 Sep 2024 at 5:04:30â€¯PM]
Last login: Sat Sep 14 17:04:28 on console
RadhaPutraAbhishektyagi@Abhisheks-MacBook-Air ~ % mysql -u root -p;
Enter password: 
  [Restored 15 Sep 2024 at 3:13:44â€¯PM]
Last login: Sun Sep 15 15:13:42 on console
RadhaPutraAbhishektyagi@Abhisheks-MacBook-Air ~ % 
  [Restored 15 Sep 2024 at 5:43:20â€¯PM]
Last login: Sun Sep 15 17:43:16 on console
RadhaPutraAbhishektyagi@Abhisheks-MacBook-Air ~ % mysql -u root -p;
Enter password: 
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 8
Server version: 8.0.31 MySQL Community Server - GPL

Copyright (c) 2000, 2022, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> show schemas;
+----------------------+
| Database             |
+----------------------+
| ABES                 |
| Aggregate            |
| bankmanagementsystem |
| Books                |
| BookShop             |
| constraints          |
| DBMS                 |
| information_schema   |
| mysql                |
| performance_schema   |
| Practice             |
| RadheKrishna         |
| Shirt                |
| Student              |
| sys                  |
| Triggers             |
| Tv_db                |
| View                 |
| windowfunc           |
+----------------------+
19 rows in set (0.00 sec)

mysql> connect windowfunc;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Connection id:    9
Current database: windowfunc

mysql> show tables;
+----------------------+
| Tables_in_windowfunc |
+----------------------+
| employees            |
+----------------------+
1 row in set (0.01 sec)

mysql> decs employees;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'decs employees' at line 1
mysql> desc employees;
+------------+-------------+------+-----+---------+----------------+
| Field      | Type        | Null | Key | Default | Extra          |
+------------+-------------+------+-----+---------+----------------+
| emp_no     | int         | NO   | PRI | NULL    | auto_increment |
| department | varchar(20) | YES  |     | NULL    |                |
| salary     | int         | YES  |     | NULL    |                |
+------------+-------------+------+-----+---------+----------------+
3 rows in set (0.01 sec)

mysql> select * from employees;
+--------+------------------+--------+
| emp_no | department       | salary |
+--------+------------------+--------+
|      1 | engineering      |  80000 |
|      2 | engineering      |  69000 |
|      3 | engineering      |  70000 |
|      4 | engineering      | 103000 |
|      5 | engineering      |  67000 |
|      6 | engineering      |  89000 |
|      7 | engineering      |  91000 |
|      8 | sales            |  59000 |
|      9 | sales            |  70000 |
|     10 | sales            | 159000 |
|     11 | sales            |  72000 |
|     12 | sales            |  60000 |
|     13 | sales            |  61000 |
|     14 | sales            |  61000 |
|     15 | customer service |  38000 |
|     16 | customer service |  45000 |
|     17 | customer service |  61000 |
|     18 | customer service |  40000 |
|     19 | customer service |  31000 |
|     20 | customer service |  56000 |
|     21 | customer service |  55000 |
+--------+------------------+--------+
21 rows in set (0.00 sec)

mysql> select Salary,Max(Salary),Min(Salary) from employees group by Salary;
+--------+-------------+-------------+
| Salary | Max(Salary) | Min(Salary) |
+--------+-------------+-------------+
|  80000 |       80000 |       80000 |
|  69000 |       69000 |       69000 |
|  70000 |       70000 |       70000 |
| 103000 |      103000 |      103000 |
|  67000 |       67000 |       67000 |
|  89000 |       89000 |       89000 |
|  91000 |       91000 |       91000 |
|  59000 |       59000 |       59000 |
| 159000 |      159000 |      159000 |
|  72000 |       72000 |       72000 |
|  60000 |       60000 |       60000 |
|  61000 |       61000 |       61000 |
|  38000 |       38000 |       38000 |
|  45000 |       45000 |       45000 |
|  40000 |       40000 |       40000 |
|  31000 |       31000 |       31000 |
|  56000 |       56000 |       56000 |
|  55000 |       55000 |       55000 |
+--------+-------------+-------------+
18 rows in set (0.00 sec)

mysql> select Salary,count(Salary) from employees group by Salary;
+--------+---------------+
| Salary | count(Salary) |
+--------+---------------+
|  80000 |             1 |
|  69000 |             1 |
|  70000 |             2 |
| 103000 |             1 |
|  67000 |             1 |
|  89000 |             1 |
|  91000 |             1 |
|  59000 |             1 |
| 159000 |             1 |
|  72000 |             1 |
|  60000 |             1 |
|  61000 |             3 |
|  38000 |             1 |
|  45000 |             1 |
|  40000 |             1 |
|  31000 |             1 |
|  56000 |             1 |
|  55000 |             1 |
+--------+---------------+
18 rows in set (0.01 sec)

mysql> select * from employees;
+--------+------------------+--------+
| emp_no | department       | salary |
+--------+------------------+--------+
|      1 | engineering      |  80000 |
|      2 | engineering      |  69000 |
|      3 | engineering      |  70000 |
|      4 | engineering      | 103000 |
|      5 | engineering      |  67000 |
|      6 | engineering      |  89000 |
|      7 | engineering      |  91000 |
|      8 | sales            |  59000 |
|      9 | sales            |  70000 |
|     10 | sales            | 159000 |
|     11 | sales            |  72000 |
|     12 | sales            |  60000 |
|     13 | sales            |  61000 |
|     14 | sales            |  61000 |
|     15 | customer service |  38000 |
|     16 | customer service |  45000 |
|     17 | customer service |  61000 |
|     18 | customer service |  40000 |
|     19 | customer service |  31000 |
|     20 | customer service |  56000 |
|     21 | customer service |  55000 |
+--------+------------------+--------+
21 rows in set (0.00 sec)

mysql> salary max(salary) from employees;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'salary max(salary) from employees' at line 1
mysql> select max(salary) from employees;
+-------------+
| max(salary) |
+-------------+
|      159000 |
+-------------+
1 row in set (0.00 sec)

mysql> select min(salary) from employees;
+-------------+
| min(salary) |
+-------------+
|       31000 |
+-------------+
1 row in set (0.00 sec)

mysql> select 159000-31000
    -> ;
+--------------+
| 159000-31000 |
+--------------+
|       128000 |
+--------------+
1 row in set (0.00 sec)

mysql> select @@global.sql_mode;
+-----------------------------------------------------------------------------------------------------------------------+
| @@global.sql_mode                                                                                                     |
+-----------------------------------------------------------------------------------------------------------------------+
| ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION |
+-----------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> select @@session.sql_mode;
+-----------------------------------------------------------------------------------------------------------------------+
| @@session.sql_mode                                                                                                    |
+-----------------------------------------------------------------------------------------------------------------------+
| ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION |
+-----------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> set session sql_mode='';
Query OK, 0 rows affected (0.00 sec)

mysql> select 2/0;
+------+
| 2/0  |
+------+
| NULL |
+------+
1 row in set (0.00 sec)

mysql> show warnings;
Empty set (0.00 sec)

mysql> select @@global.sql_mode;
+-----------------------------------------------------------------------------------------------------------------------+
| @@global.sql_mode                                                                                                     |
+-----------------------------------------------------------------------------------------------------------------------+
| ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION |
+-----------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> set session sql_mode='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';
Query OK, 0 rows affected (0.00 sec)

mysql> select 2/0;
+------+
| 2/0  |
+------+
| NULL |
+------+
1 row in set, 1 warning (0.00 sec)

mysql> shoiw warnings;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'shoiw warnings' at line 1
mysql> show warnings;
+-------+------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Level | Code | Message                                                                                                                                                          |
+-------+------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Error | 1064 | You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'shoiw warnings' at line 1 |
+-------+------+------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> select 2/0;
+------+
| 2/0  |
+------+
| NULL |
+------+
1 row in set, 1 warning (0.00 sec)

mysql> show warnings;
+---------+------+---------------+
| Level   | Code | Message       |
+---------+------+---------------+
| Warning | 1365 | Division by 0 |
+---------+------+---------------+
1 row in set (0.00 sec)

mysql> select * from employee;s
ERROR 1146 (42S02): Table 'windowfunc.employee' doesn't exist
    -> select * from employees;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 's
select * from employees' at line 1
mysql> select * from employees;
+--------+------------------+--------+
| emp_no | department       | salary |
+--------+------------------+--------+
|      1 | engineering      |  80000 |
|      2 | engineering      |  69000 |
|      3 | engineering      |  70000 |
|      4 | engineering      | 103000 |
|      5 | engineering      |  67000 |
|      6 | engineering      |  89000 |
|      7 | engineering      |  91000 |
|      8 | sales            |  59000 |
|      9 | sales            |  70000 |
|     10 | sales            | 159000 |
|     11 | sales            |  72000 |
|     12 | sales            |  60000 |
|     13 | sales            |  61000 |
|     14 | sales            |  61000 |
|     15 | customer service |  38000 |
|     16 | customer service |  45000 |
|     17 | customer service |  61000 |
|     18 | customer service |  40000 |
|     19 | customer service |  31000 |
|     20 | customer service |  56000 |
|     21 | customer service |  55000 |
+--------+------------------+--------+
21 rows in set (0.01 sec)

mysql> select department,Salary from employees group by Department;
ERROR 1055 (42000): Expression #2 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'windowfunc.employees.salary' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by
mysql> set session sql_mode='';
Query OK, 0 rows affected (0.00 sec)

mysql> select department,Salary from employees group by Department;
+------------------+--------+
| department       | Salary |
+------------------+--------+
| engineering      |  80000 |
| sales            |  59000 |
| customer service |  38000 |
+------------------+--------+
3 rows in set (0.01 sec)

mysql> set session sql_mode='Only_full_group_by';
Query OK, 0 rows affected (0.00 sec)

mysql> select department,Salary from employees group by Department;
ERROR 1055 (42000): Expression #2 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'windowfunc.employees.salary' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by
mysql> show warnings;
+-------+------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Level | Code | Message                                                                                                                                                                                                                                         |
+-------+------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Error | 1055 | Expression #2 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'windowfunc.employees.salary' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by |
+-------+------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> select @@session.sql_mode;
+--------------------+
| @@session.sql_mode |
+--------------------+
| ONLY_FULL_GROUP_BY |
+--------------------+
1 row in set (0.00 sec)

mysql> select @@global.sql_mode;
+-----------------------------------------------------------------------------------------------------------------------+
| @@global.sql_mode                                                                                                     |
+-----------------------------------------------------------------------------------------------------------------------+
| ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION |
+-----------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> set session sql_mode='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';
Query OK, 0 rows affected (0.00 sec)

mysql> select @@session.sql_mode;
+-----------------------------------------------------------------------------------------------------------------------+
| @@session.sql_mode                                                                                                    |
+-----------------------------------------------------------------------------------------------------------------------+
| ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION |
+-----------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> select * from employees;
+--------+------------------+--------+
| emp_no | department       | salary |
+--------+------------------+--------+
|      1 | engineering      |  80000 |
|      2 | engineering      |  69000 |
|      3 | engineering      |  70000 |
|      4 | engineering      | 103000 |
|      5 | engineering      |  67000 |
|      6 | engineering      |  89000 |
|      7 | engineering      |  91000 |
|      8 | sales            |  59000 |
|      9 | sales            |  70000 |
|     10 | sales            | 159000 |
|     11 | sales            |  72000 |
|     12 | sales            |  60000 |
|     13 | sales            |  61000 |
|     14 | sales            |  61000 |
|     15 | customer service |  38000 |
|     16 | customer service |  45000 |
|     17 | customer service |  61000 |
|     18 | customer service |  40000 |
|     19 | customer service |  31000 |
|     20 | customer service |  56000 |
|     21 | customer service |  55000 |
+--------+------------------+--------+
21 rows in set (0.00 sec)

mysql> select emp_no,department,salary,Avg(Salary) Over(Partition by department) as Dept_Avg from employees;
+--------+------------------+--------+------------+
| emp_no | department       | salary | Dept_Avg   |
+--------+------------------+--------+------------+
|     15 | customer service |  38000 | 46571.4286 |
|     16 | customer service |  45000 | 46571.4286 |
|     17 | customer service |  61000 | 46571.4286 |
|     18 | customer service |  40000 | 46571.4286 |
|     19 | customer service |  31000 | 46571.4286 |
|     20 | customer service |  56000 | 46571.4286 |
|     21 | customer service |  55000 | 46571.4286 |
|      1 | engineering      |  80000 | 81285.7143 |
|      2 | engineering      |  69000 | 81285.7143 |
|      3 | engineering      |  70000 | 81285.7143 |
|      4 | engineering      | 103000 | 81285.7143 |
|      5 | engineering      |  67000 | 81285.7143 |
|      6 | engineering      |  89000 | 81285.7143 |
|      7 | engineering      |  91000 | 81285.7143 |
|      8 | sales            |  59000 | 77428.5714 |
|      9 | sales            |  70000 | 77428.5714 |
|     10 | sales            | 159000 | 77428.5714 |
|     11 | sales            |  72000 | 77428.5714 |
|     12 | sales            |  60000 | 77428.5714 |
|     13 | sales            |  61000 | 77428.5714 |
|     14 | sales            |  61000 | 77428.5714 |
+--------+------------------+--------+------------+
21 rows in set (0.00 sec)

mysql> select 38000+45000+61000+40000+31000+56000+55000;
+-------------------------------------------+
| 38000+45000+61000+40000+31000+56000+55000 |
+-------------------------------------------+
|                                    326000 |
+-------------------------------------------+
1 row in set (0.00 sec)

mysql> select 326000/7;
+------------+
| 326000/7   |
+------------+
| 46571.4286 |
+------------+
1 row in set (0.00 sec)

mysql> select emp_no,department,salary,Avg(Salary) Over() as Dept_Avg from employees;
+--------+------------------+--------+------------+
| emp_no | department       | salary | Dept_Avg   |
+--------+------------------+--------+------------+
|      1 | engineering      |  80000 | 68428.5714 |
|      2 | engineering      |  69000 | 68428.5714 |
|      3 | engineering      |  70000 | 68428.5714 |
|      4 | engineering      | 103000 | 68428.5714 |
|      5 | engineering      |  67000 | 68428.5714 |
|      6 | engineering      |  89000 | 68428.5714 |
|      7 | engineering      |  91000 | 68428.5714 |
|      8 | sales            |  59000 | 68428.5714 |
|      9 | sales            |  70000 | 68428.5714 |
|     10 | sales            | 159000 | 68428.5714 |
|     11 | sales            |  72000 | 68428.5714 |
|     12 | sales            |  60000 | 68428.5714 |
|     13 | sales            |  61000 | 68428.5714 |
|     14 | sales            |  61000 | 68428.5714 |
|     15 | customer service |  38000 | 68428.5714 |
|     16 | customer service |  45000 | 68428.5714 |
|     17 | customer service |  61000 | 68428.5714 |
|     18 | customer service |  40000 | 68428.5714 |
|     19 | customer service |  31000 | 68428.5714 |
|     20 | customer service |  56000 | 68428.5714 |
|     21 | customer service |  55000 | 68428.5714 |
+--------+------------------+--------+------------+
21 rows in set (0.00 sec)

mysql> select sum(Salary) from employees;
+-------------+
| sum(Salary) |
+-------------+
|     1437000 |
+-------------+
1 row in set (0.00 sec)

mysql> select 1437000/21
    -> ;
+------------+
| 1437000/21 |
+------------+
| 68428.5714 |
+------------+
1 row in set (0.00 sec)

mysql> select sum(Salary) from employees where department='engineering';
+-------------+
| sum(Salary) |
+-------------+
|      569000 |
+-------------+
1 row in set (0.00 sec)

mysql> select sum(Salary) from employees where department='customer service';
+-------------+
| sum(Salary) |
+-------------+
|      326000 |
+-------------+
1 row in set (0.00 sec)

mysql> select 569000/7;
+------------+
| 569000/7   |
+------------+
| 81285.7143 |
+------------+
1 row in set (0.00 sec)

mysql> show tables;
+----------------------+
| Tables_in_windowfunc |
+----------------------+
| employees            |
+----------------------+
1 row in set (0.00 sec)

mysql> select * from emplployees;
ERROR 1146 (42S02): Table 'windowfunc.emplployees' doesn't exist
mysql> select * from employees;
+--------+------------------+--------+
| emp_no | department       | salary |
+--------+------------------+--------+
|      1 | engineering      |  80000 |
|      2 | engineering      |  69000 |
|      3 | engineering      |  70000 |
|      4 | engineering      | 103000 |
|      5 | engineering      |  67000 |
|      6 | engineering      |  89000 |
|      7 | engineering      |  91000 |
|      8 | sales            |  59000 |
|      9 | sales            |  70000 |
|     10 | sales            | 159000 |
|     11 | sales            |  72000 |
|     12 | sales            |  60000 |
|     13 | sales            |  61000 |
|     14 | sales            |  61000 |
|     15 | customer service |  38000 |
|     16 | customer service |  45000 |
|     17 | customer service |  61000 |
|     18 | customer service |  40000 |
|     19 | customer service |  31000 |
|     20 | customer service |  56000 |
|     21 | customer service |  55000 |
+--------+------------------+--------+
21 rows in set (0.00 sec)

mysql> select departments,count(*) from employees group by department;
ERROR 1054 (42S22): Unknown column 'departments' in 'field list'
mysql> select department,count(*) from employees group by department;
+------------------+----------+
| department       | count(*) |
+------------------+----------+
| engineering      |        7 |
| sales            |        7 |
| customer service |        7 |
+------------------+----------+
3 rows in set (0.00 sec)

mysql> show schemas;
+----------------------+
| Database             |
+----------------------+
| ABES                 |
| Aggregate            |
| bankmanagementsystem |
| Books                |
| BookShop             |
| constraints          |
| DBMS                 |
| information_schema   |
| mysql                |
| performance_schema   |
| Practice             |
| RadheKrishna         |
| Shirt                |
| Student              |
| sys                  |
| Triggers             |
| Tv_db                |
| View                 |
| windowfunc           |
+----------------------+
19 rows in set (0.00 sec)

mysql> desc tv_db;
ERROR 1146 (42S02): Table 'windowfunc.tv_db' doesn't exist
mysql> show schemas;
+----------------------+
| Database             |
+----------------------+
| ABES                 |
| Aggregate            |
| bankmanagementsystem |
| Books                |
| BookShop             |
| constraints          |
| DBMS                 |
| information_schema   |
| mysql                |
| performance_schema   |
| Practice             |
| RadheKrishna         |
| Shirt                |
| Student              |
| sys                  |
| Triggers             |
| Tv_db                |
| View                 |
| windowfunc           |
+----------------------+
19 rows in set (0.00 sec)

mysql> use tv_db;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> show tables;
+-----------------+
| Tables_in_tv_db |
+-----------------+
| Dat             |
| emp             |
| full_review     |
| name            |
| reviewers       |
| reviews         |
| series          |
+-----------------+
7 rows in set (0.00 sec)

mysql> select * from full_review;
+----+--------+-----------+-------------+
| id | rating | series_id | reviewer_id |
+----+--------+-----------+-------------+
|  1 |    8.0 |         1 |           1 |
|  2 |    7.5 |         1 |           2 |
|  3 |    8.5 |         1 |           3 |
|  4 |    7.7 |         1 |           4 |
|  5 |    8.9 |         1 |           5 |
|  6 |    8.1 |         2 |           1 |
|  7 |    6.0 |         2 |           4 |
|  8 |    8.0 |         2 |           3 |
|  9 |    8.4 |         2 |           6 |
| 10 |    9.9 |         2 |           5 |
| 11 |    7.0 |         3 |           1 |
| 12 |    7.5 |         3 |           6 |
| 13 |    8.0 |         3 |           4 |
| 14 |    7.1 |         3 |           3 |
| 15 |    8.0 |         3 |           5 |
| 16 |    7.5 |         4 |           1 |
| 17 |    7.8 |         4 |           3 |
| 18 |    8.3 |         4 |           4 |
| 19 |    7.6 |         4 |           2 |
| 20 |    8.5 |         4 |           5 |
| 21 |    9.5 |         5 |           1 |
| 22 |    9.0 |         5 |           3 |
| 23 |    9.1 |         5 |           4 |
| 24 |    9.3 |         5 |           2 |
| 25 |    9.9 |         5 |           5 |
| 26 |    6.5 |         6 |           2 |
| 27 |    7.8 |         6 |           3 |
| 28 |    8.8 |         6 |           4 |
| 29 |    8.4 |         6 |           2 |
| 30 |    9.1 |         6 |           5 |
| 31 |    9.1 |         7 |           2 |
| 32 |    9.7 |         7 |           5 |
| 33 |    8.5 |         8 |           4 |
| 34 |    7.8 |         8 |           2 |
| 35 |    8.8 |         8 |           6 |
| 36 |    9.3 |         8 |           5 |
| 37 |    5.5 |         9 |           2 |
| 38 |    6.8 |         9 |           3 |
| 39 |    5.8 |         9 |           4 |
| 40 |    4.3 |         9 |           6 |
| 41 |    4.5 |         9 |           5 |
| 42 |    9.9 |        10 |           5 |
| 43 |    8.0 |        13 |           3 |
| 44 |    7.2 |        13 |           4 |
| 45 |    8.5 |        14 |           2 |
| 46 |    8.9 |        14 |           3 |
| 47 |    8.9 |        14 |           4 |
| 48 |    0.0 |      NULL |        NULL |
| 49 |    0.0 |      NULL |        NULL |
+----+--------+-----------+-------------+
49 rows in set (0.00 sec)

mysql> delete from full_review where id in(48,49);
Query OK, 2 rows affected (0.01 sec)

mysql> select * from full_review;
+----+--------+-----------+-------------+
| id | rating | series_id | reviewer_id |
+----+--------+-----------+-------------+
|  1 |    8.0 |         1 |           1 |
|  2 |    7.5 |         1 |           2 |
|  3 |    8.5 |         1 |           3 |
|  4 |    7.7 |         1 |           4 |
|  5 |    8.9 |         1 |           5 |
|  6 |    8.1 |         2 |           1 |
|  7 |    6.0 |         2 |           4 |
|  8 |    8.0 |         2 |           3 |
|  9 |    8.4 |         2 |           6 |
| 10 |    9.9 |         2 |           5 |
| 11 |    7.0 |         3 |           1 |
| 12 |    7.5 |         3 |           6 |
| 13 |    8.0 |         3 |           4 |
| 14 |    7.1 |         3 |           3 |
| 15 |    8.0 |         3 |           5 |
| 16 |    7.5 |         4 |           1 |
| 17 |    7.8 |         4 |           3 |
| 18 |    8.3 |         4 |           4 |
| 19 |    7.6 |         4 |           2 |
| 20 |    8.5 |         4 |           5 |
| 21 |    9.5 |         5 |           1 |
| 22 |    9.0 |         5 |           3 |
| 23 |    9.1 |         5 |           4 |
| 24 |    9.3 |         5 |           2 |
| 25 |    9.9 |         5 |           5 |
| 26 |    6.5 |         6 |           2 |
| 27 |    7.8 |         6 |           3 |
| 28 |    8.8 |         6 |           4 |
| 29 |    8.4 |         6 |           2 |
| 30 |    9.1 |         6 |           5 |
| 31 |    9.1 |         7 |           2 |
| 32 |    9.7 |         7 |           5 |
| 33 |    8.5 |         8 |           4 |
| 34 |    7.8 |         8 |           2 |
| 35 |    8.8 |         8 |           6 |
| 36 |    9.3 |         8 |           5 |
| 37 |    5.5 |         9 |           2 |
| 38 |    6.8 |         9 |           3 |
| 39 |    5.8 |         9 |           4 |
| 40 |    4.3 |         9 |           6 |
| 41 |    4.5 |         9 |           5 |
| 42 |    9.9 |        10 |           5 |
| 43 |    8.0 |        13 |           3 |
| 44 |    7.2 |        13 |           4 |
| 45 |    8.5 |        14 |           2 |
| 46 |    8.9 |        14 |           3 |
| 47 |    8.9 |        14 |           4 |
+----+--------+-----------+-------------+
47 rows in set (0.00 sec)

mysql> show tables;
+-----------------+
| Tables_in_tv_db |
+-----------------+
| Dat             |
| emp             |
| full_review     |
| name            |
| reviewers       |
| reviews         |
| series          |
+-----------------+
7 rows in set (0.00 sec)

mysql> select * from name;
+----+------------+-----------+
| id | first_name | last_name |
+----+------------+-----------+
|  1 | Thomas     | Stoneman  |
|  2 | Wyatt      | Skaggs    |
|  3 | Kimbra     | Masters   |
|  4 | Domingo    | Cortes    |
|  5 | Colt       | Steele    |
|  6 | Pinkie     | Petit     |
|  7 | Marlon     | Crafford  |
+----+------------+-----------+
7 rows in set (0.00 sec)

mysql> show views;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'views' at line 1
mysql> show view;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'view' at line 1
mysql> show create view name;
+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+
| View | Create View                                                                                                                                                                                                                | character_set_client | collation_connection |
+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+
| name | CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `name` AS select `reviewers`.`id` AS `id`,`reviewers`.`first_name` AS `first_name`,`reviewers`.`last_name` AS `last_name` from `reviewers` | utf8mb4              | utf8mb4_0900_ai_ci   |
+------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+
1 row in set (0.00 sec)

mysql> show tables;
+-----------------+
| Tables_in_tv_db |
+-----------------+
| Dat             |
| emp             |
| full_review     |
| name            |
| reviewers       |
| reviews         |
| series          |
+-----------------+
7 rows in set (0.00 sec)

mysql> show schemas;
+----------------------+
| Database             |
+----------------------+
| ABES                 |
| Aggregate            |
| bankmanagementsystem |
| Books                |
| BookShop             |
| constraints          |
| DBMS                 |
| information_schema   |
| mysql                |
| performance_schema   |
| Practice             |
| RadheKrishna         |
| Shirt                |
| Student              |
| sys                  |
| Triggers             |
| Tv_db                |
| View                 |
| windowfunc           |
+----------------------+
19 rows in set (0.00 sec)

mysql> connect view;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Connection id:    12
Current database: view

mysql> show tables;
+----------------+
| Tables_in_view |
+----------------+
| details        |
| emp            |
| emp_salary3    |
| empl_salary3   |
| employee       |
| Marks          |
| record         |
| Student        |
| teacher        |
+----------------+
9 rows in set (0.00 sec)

mysql> use aggregate;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> show tables;
+---------------------+
| Tables_in_aggregate |
+---------------------+
| Arrange             |
| captions            |
| customers           |
| Employee            |
| Money               |
| orders              |
| papers              |
| People              |
| Reviewers           |
| Reviews             |
| Series              |
| Students            |
+---------------------+
12 rows in set (0.00 sec)

mysql> desc customer;
ERROR 1146 (42S02): Table 'aggregate.customer' doesn't exist
mysql> desc customers;
+------------+-------------+------+-----+---------+----------------+
| Field      | Type        | Null | Key | Default | Extra          |
+------------+-------------+------+-----+---------+----------------+
| id         | int         | NO   | PRI | NULL    | auto_increment |
| first_name | varchar(50) | YES  |     | NULL    |                |
| last_name  | varchar(50) | YES  |     | NULL    |                |
| email      | varchar(50) | YES  |     | NULL    |                |
+------------+-------------+------+-----+---------+----------------+
4 rows in set (0.00 sec)

mysql> select * from customers;
+----+------------+-----------+-----------------+
| id | first_name | last_name | email           |
+----+------------+-----------+-----------------+
|  3 | David      | Bowie     | david@gmail.com |
|  4 | Blue       | Steele    | blue@gmail.com  |
|  5 | Bette      | Davis     | bette@aol.com   |
+----+------------+-----------+-----------------+
3 rows in set (0.00 sec)

mysql> select * from order;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'order' at line 1
mysql> select * from orders;
+----+------------+--------+-------------+
| id | order_date | amount | customer_id |
+----+------------+--------+-------------+
|  5 | 1999-04-11 | 450.25 |           5 |
+----+------------+--------+-------------+
1 row in set (0.00 sec)

mysql> truncate table customers;
ERROR 1701 (42000): Cannot truncate a table referenced in a foreign key constraint (`Aggregate`.`orders`, CONSTRAINT `orders_ibfk_1`)
mysql> show create table orders;
+--------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table  | Create Table                                                                                                                                                                                                                                                                                                                                                                                                                  |
+--------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| orders | CREATE TABLE `orders` (
  `id` int NOT NULL AUTO_INCREMENT,
  `order_date` date DEFAULT NULL,
  `amount` decimal(8,2) DEFAULT NULL,
  `customer_id` int DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `customer_id` (`customer_id`),
  CONSTRAINT `orders_ibfk_1` FOREIGN KEY (`customer_id`) REFERENCES `customers` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci |
+--------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> desc order;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'order' at line 1
mysql> desc orders;
+-------------+--------------+------+-----+---------+----------------+
| Field       | Type         | Null | Key | Default | Extra          |
+-------------+--------------+------+-----+---------+----------------+
| id          | int          | NO   | PRI | NULL    | auto_increment |
| order_date  | date         | YES  |     | NULL    |                |
| amount      | decimal(8,2) | YES  |     | NULL    |                |
| customer_id | int          | YES  | MUL | NULL    |                |
+-------------+--------------+------+-----+---------+----------------+
4 rows in set (0.00 sec)

mysql> select * from orders;
+----+------------+--------+-------------+
| id | order_date | amount | customer_id |
+----+------------+--------+-------------+
|  5 | 1999-04-11 | 450.25 |           5 |
+----+------------+--------+-------------+
1 row in set (0.00 sec)

mysql> drop table orders;
Query OK, 0 rows affected (0.01 sec)

mysql> show tables;
+---------------------+
| Tables_in_aggregate |
+---------------------+
| Arrange             |
| captions            |
| customers           |
| Employee            |
| Money               |
| papers              |
| People              |
| Reviewers           |
| Reviews             |
| Series              |
| Students            |
+---------------------+
11 rows in set (0.00 sec)

mysql> desc customers;
+------------+-------------+------+-----+---------+----------------+
| Field      | Type        | Null | Key | Default | Extra          |
+------------+-------------+------+-----+---------+----------------+
| id         | int         | NO   | PRI | NULL    | auto_increment |
| first_name | varchar(50) | YES  |     | NULL    |                |
| last_name  | varchar(50) | YES  |     | NULL    |                |
| email      | varchar(50) | YES  |     | NULL    |                |
+------------+-------------+------+-----+---------+----------------+
4 rows in set (0.00 sec)

mysql> select * from customers;
+----+------------+-----------+-----------------+
| id | first_name | last_name | email           |
+----+------------+-----------+-----------------+
|  3 | David      | Bowie     | david@gmail.com |
|  4 | Blue       | Steele    | blue@gmail.com  |
|  5 | Bette      | Davis     | bette@aol.com   |
+----+------------+-----------+-----------------+
3 rows in set (0.00 sec)

mysql> trucate table customers;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'trucate table customers' at line 1
mysql> truncate table customers;
Query OK, 0 rows affected (0.01 sec)

mysql> select * from customers;
Empty set (0.00 sec)

mysql> create table order
    -> (
    -> order_id int primary key,
    -> Order_date date,
    -> Amount decimal(8,2),
    -> customer_id int,
    -> foreign key(customer_id) references Customers(id) on delete cascade
    -> );
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'order
(
order_id int primary key,
Order_date date,
Amount decimal(8,2),
customer' at line 1
mysql> create table order ( order_id int primary key, Order_date date, Amount decimal(8,2), customer_id int, foreign key(customer_id) references Customers(id) on delete cascade);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'order ( order_id int primary key, Order_date date, Amount decimal(8,2), customer' at line 1
mysql> create table orders(order_id int primary key, Order_date date, Amount decimal(8,2), customer_id int, foreign key(customer_id) references Customers(id) on delete cascade);
Query OK, 0 rows affected (0.01 sec)

mysql> 
mysql> desc orders;
+-------------+--------------+------+-----+---------+-------+
| Field       | Type         | Null | Key | Default | Extra |
+-------------+--------------+------+-----+---------+-------+
| order_id    | int          | NO   | PRI | NULL    |       |
| Order_date  | date         | YES  |     | NULL    |       |
| Amount      | decimal(8,2) | YES  |     | NULL    |       |
| customer_id | int          | YES  | MUL | NULL    |       |
+-------------+--------------+------+-----+---------+-------+
4 rows in set (0.01 sec)

mysql> show create table order;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'order' at line 1
mysql> show create table orders;
+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table  | Create Table                                                                                                                                                                                                                                                                                                                                                                                              |
+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| orders | CREATE TABLE `orders` (
  `order_id` int NOT NULL,
  `Order_date` date DEFAULT NULL,
  `Amount` decimal(8,2) DEFAULT NULL,
  `customer_id` int DEFAULT NULL,
  PRIMARY KEY (`order_id`),
  KEY `customer_id` (`customer_id`),
  CONSTRAINT `orders_ibfk_1` FOREIGN KEY (`customer_id`) REFERENCES `Customers` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci |
+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> select * from customers;
Empty set (0.00 sec)

mysql> desc customers;
+------------+-------------+------+-----+---------+----------------+
| Field      | Type        | Null | Key | Default | Extra          |
+------------+-------------+------+-----+---------+----------------+
| id         | int         | NO   | PRI | NULL    | auto_increment |
| first_name | varchar(50) | YES  |     | NULL    |                |
| last_name  | varchar(50) | YES  |     | NULL    |                |
| email      | varchar(50) | YES  |     | NULL    |                |
+------------+-------------+------+-----+---------+----------------+
4 rows in set (0.00 sec)

mysql> insert into customers(id,first_Name,Last_Name,email) values(1,'Abhishek','Tyagi','abhishek.mca20@gmail.com');
Query OK, 1 row affected (0.00 sec)

mysql> insert into customers(id,first_Name,Last_Name,email) values(2,'Radha','Krishan','radha.mca20@gmail.com');
Query OK, 1 row affected (0.01 sec)

mysql> select * from customers;
+----+------------+-----------+--------------------------+
| id | first_name | last_name | email                    |
+----+------------+-----------+--------------------------+
|  1 | Abhishek   | Tyagi     | abhishek.mca20@gmail.com |
|  2 | Radha      | Krishan   | radha.mca20@gmail.com    |
+----+------------+-----------+--------------------------+
2 rows in set (0.01 sec)

mysql> desc orders;
+-------------+--------------+------+-----+---------+-------+
| Field       | Type         | Null | Key | Default | Extra |
+-------------+--------------+------+-----+---------+-------+
| order_id    | int          | NO   | PRI | NULL    |       |
| Order_date  | date         | YES  |     | NULL    |       |
| Amount      | decimal(8,2) | YES  |     | NULL    |       |
| customer_id | int          | YES  | MUL | NULL    |       |
+-------------+--------------+------+-----+---------+-------+
4 rows in set (0.01 sec)

mysql> insert into orders values(1,'2024-09-15',120000.34,1),(2,'2023-09-15',13000.32,2);
Query OK, 2 rows affected (0.00 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> select * from orders;
+----------+------------+-----------+-------------+
| order_id | Order_date | Amount    | customer_id |
+----------+------------+-----------+-------------+
|        1 | 2024-09-15 | 120000.34 |           1 |
|        2 | 2023-09-15 |  13000.32 |           2 |
+----------+------------+-----------+-------------+
2 rows in set (0.00 sec)

mysql> insert into orders values(3,'2025-09-15',160000.34,3);
ERROR 1452 (23000): Cannot add or update a child row: a foreign key constraint fails (`aggregate`.`orders`, CONSTRAINT `orders_ibfk_1` FOREIGN KEY (`customer_id`) REFERENCES `customers` (`id`) ON DELETE CASCADE)
mysql> select * from customers;
+----+------------+-----------+--------------------------+
| id | first_name | last_name | email                    |
+----+------------+-----------+--------------------------+
|  1 | Abhishek   | Tyagi     | abhishek.mca20@gmail.com |
|  2 | Radha      | Krishan   | radha.mca20@gmail.com    |
+----+------------+-----------+--------------------------+
2 rows in set (0.00 sec)

mysql> delete from customers where id=1;
Query OK, 1 row affected (0.00 sec)

mysql> select * from customers;
+----+------------+-----------+-----------------------+
| id | first_name | last_name | email                 |
+----+------------+-----------+-----------------------+
|  2 | Radha      | Krishan   | radha.mca20@gmail.com |
+----+------------+-----------+-----------------------+
1 row in set (0.00 sec)

mysql> select * from orders;
+----------+------------+----------+-------------+
| order_id | Order_date | Amount   | customer_id |
+----------+------------+----------+-------------+
|        2 | 2023-09-15 | 13000.32 |           2 |
+----------+------------+----------+-------------+
1 row in set (0.00 sec)

mysql> select * from employees;
ERROR 1146 (42S02): Table 'aggregate.employees' doesn't exist
mysql> connect wondowfunc;
ERROR 1049 (42000): Unknown database 'wondowfunc'
mysql> connect windowfunc;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Connection id:    14
Current database: windowfunc

mysql> show tables;
+----------------------+
| Tables_in_windowfunc |
+----------------------+
| employees            |
+----------------------+
1 row in set (0.01 sec)

mysql> select * from employees;
+--------+------------------+--------+
| emp_no | department       | salary |
+--------+------------------+--------+
|      1 | engineering      |  80000 |
|      2 | engineering      |  69000 |
|      3 | engineering      |  70000 |
|      4 | engineering      | 103000 |
|      5 | engineering      |  67000 |
|      6 | engineering      |  89000 |
|      7 | engineering      |  91000 |
|      8 | sales            |  59000 |
|      9 | sales            |  70000 |
|     10 | sales            | 159000 |
|     11 | sales            |  72000 |
|     12 | sales            |  60000 |
|     13 | sales            |  61000 |
|     14 | sales            |  61000 |
|     15 | customer service |  38000 |
|     16 | customer service |  45000 |
|     17 | customer service |  61000 |
|     18 | customer service |  40000 |
|     19 | customer service |  31000 |
|     20 | customer service |  56000 |
|     21 | customer service |  55000 |
+--------+------------------+--------+
21 rows in set (0.00 sec)

mysql> select
    -> emp_no,Deapartment,Salary,
    -> Avg(salary) over(Partition by department) from employees;
ERROR 1054 (42S22): Unknown column 'Deapartment' in 'field list'
mysql> select  emp_no,Department,Salary, Avg(salary) over(Partition by department) from employees;
+--------+------------------+--------+-------------------------------------------+
| emp_no | Department       | Salary | Avg(salary) over(Partition by department) |
+--------+------------------+--------+-------------------------------------------+
|     15 | customer service |  38000 |                                46571.4286 |
|     16 | customer service |  45000 |                                46571.4286 |
|     17 | customer service |  61000 |                                46571.4286 |
|     18 | customer service |  40000 |                                46571.4286 |
|     19 | customer service |  31000 |                                46571.4286 |
|     20 | customer service |  56000 |                                46571.4286 |
|     21 | customer service |  55000 |                                46571.4286 |
|      1 | engineering      |  80000 |                                81285.7143 |
|      2 | engineering      |  69000 |                                81285.7143 |
|      3 | engineering      |  70000 |                                81285.7143 |
|      4 | engineering      | 103000 |                                81285.7143 |
|      5 | engineering      |  67000 |                                81285.7143 |
|      6 | engineering      |  89000 |                                81285.7143 |
|      7 | engineering      |  91000 |                                81285.7143 |
|      8 | sales            |  59000 |                                77428.5714 |
|      9 | sales            |  70000 |                                77428.5714 |
|     10 | sales            | 159000 |                                77428.5714 |
|     11 | sales            |  72000 |                                77428.5714 |
|     12 | sales            |  60000 |                                77428.5714 |
|     13 | sales            |  61000 |                                77428.5714 |
|     14 | sales            |  61000 |                                77428.5714 |
+--------+------------------+--------+-------------------------------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary, Avg(salary) over(Partition by department) as Dept_Salary from employees;
+--------+------------------+--------+-------------+
| emp_no | Department       | Salary | Dept_Salary |
+--------+------------------+--------+-------------+
|     15 | customer service |  38000 |  46571.4286 |
|     16 | customer service |  45000 |  46571.4286 |
|     17 | customer service |  61000 |  46571.4286 |
|     18 | customer service |  40000 |  46571.4286 |
|     19 | customer service |  31000 |  46571.4286 |
|     20 | customer service |  56000 |  46571.4286 |
|     21 | customer service |  55000 |  46571.4286 |
|      1 | engineering      |  80000 |  81285.7143 |
|      2 | engineering      |  69000 |  81285.7143 |
|      3 | engineering      |  70000 |  81285.7143 |
|      4 | engineering      | 103000 |  81285.7143 |
|      5 | engineering      |  67000 |  81285.7143 |
|      6 | engineering      |  89000 |  81285.7143 |
|      7 | engineering      |  91000 |  81285.7143 |
|      8 | sales            |  59000 |  77428.5714 |
|      9 | sales            |  70000 |  77428.5714 |
|     10 | sales            | 159000 |  77428.5714 |
|     11 | sales            |  72000 |  77428.5714 |
|     12 | sales            |  60000 |  77428.5714 |
|     13 | sales            |  61000 |  77428.5714 |
|     14 | sales            |  61000 |  77428.5714 |
+--------+------------------+--------+-------------+
21 rows in set (0.00 sec)

mysql> Select avg(salary) from employees;
+-------------+
| avg(salary) |
+-------------+
|  68428.5714 |
+-------------+
1 row in set (0.00 sec)

mysql> select  emp_no,Department,Salary, Avg(salary) over(Partition by department) as Dept_Salary,Avg(Salary) over() as Average_Salary from employees;
+--------+------------------+--------+-------------+----------------+
| emp_no | Department       | Salary | Dept_Salary | Average_Salary |
+--------+------------------+--------+-------------+----------------+
|     15 | customer service |  38000 |  46571.4286 |     68428.5714 |
|     16 | customer service |  45000 |  46571.4286 |     68428.5714 |
|     17 | customer service |  61000 |  46571.4286 |     68428.5714 |
|     18 | customer service |  40000 |  46571.4286 |     68428.5714 |
|     19 | customer service |  31000 |  46571.4286 |     68428.5714 |
|     20 | customer service |  56000 |  46571.4286 |     68428.5714 |
|     21 | customer service |  55000 |  46571.4286 |     68428.5714 |
|      1 | engineering      |  80000 |  81285.7143 |     68428.5714 |
|      2 | engineering      |  69000 |  81285.7143 |     68428.5714 |
|      3 | engineering      |  70000 |  81285.7143 |     68428.5714 |
|      4 | engineering      | 103000 |  81285.7143 |     68428.5714 |
|      5 | engineering      |  67000 |  81285.7143 |     68428.5714 |
|      6 | engineering      |  89000 |  81285.7143 |     68428.5714 |
|      7 | engineering      |  91000 |  81285.7143 |     68428.5714 |
|      8 | sales            |  59000 |  77428.5714 |     68428.5714 |
|      9 | sales            |  70000 |  77428.5714 |     68428.5714 |
|     10 | sales            | 159000 |  77428.5714 |     68428.5714 |
|     11 | sales            |  72000 |  77428.5714 |     68428.5714 |
|     12 | sales            |  60000 |  77428.5714 |     68428.5714 |
|     13 | sales            |  61000 |  77428.5714 |     68428.5714 |
|     14 | sales            |  61000 |  77428.5714 |     68428.5714 |
+--------+------------------+--------+-------------+----------------+
21 rows in set (0.00 sec)

mysql> select department,Avg(Salary) from employees group by department
    -> ;
+------------------+-------------+
| department       | Avg(Salary) |
+------------------+-------------+
| engineering      |  81285.7143 |
| sales            |  77428.5714 |
| customer service |  46571.4286 |
+------------------+-------------+
3 rows in set (0.00 sec)

mysql> select emp_no,Salary,department,Avg(Salary) from employees group by department,emp_no,Salary;
+--------+--------+------------------+-------------+
| emp_no | Salary | department       | Avg(Salary) |
+--------+--------+------------------+-------------+
|      1 |  80000 | engineering      |  80000.0000 |
|      2 |  69000 | engineering      |  69000.0000 |
|      3 |  70000 | engineering      |  70000.0000 |
|      4 | 103000 | engineering      | 103000.0000 |
|      5 |  67000 | engineering      |  67000.0000 |
|      6 |  89000 | engineering      |  89000.0000 |
|      7 |  91000 | engineering      |  91000.0000 |
|      8 |  59000 | sales            |  59000.0000 |
|      9 |  70000 | sales            |  70000.0000 |
|     10 | 159000 | sales            | 159000.0000 |
|     11 |  72000 | sales            |  72000.0000 |
|     12 |  60000 | sales            |  60000.0000 |
|     13 |  61000 | sales            |  61000.0000 |
|     14 |  61000 | sales            |  61000.0000 |
|     15 |  38000 | customer service |  38000.0000 |
|     16 |  45000 | customer service |  45000.0000 |
|     17 |  61000 | customer service |  61000.0000 |
|     18 |  40000 | customer service |  40000.0000 |
|     19 |  31000 | customer service |  31000.0000 |
|     20 |  56000 | customer service |  56000.0000 |
|     21 |  55000 | customer service |  55000.0000 |
+--------+--------+------------------+-------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary, Avg(salary) over(Partition by department) as Dept_Salary,Avg(Salary) over() as Average_Salary from employees;
+--------+------------------+--------+-------------+----------------+
| emp_no | Department       | Salary | Dept_Salary | Average_Salary |
+--------+------------------+--------+-------------+----------------+
|     15 | customer service |  38000 |  46571.4286 |     68428.5714 |
|     16 | customer service |  45000 |  46571.4286 |     68428.5714 |
|     17 | customer service |  61000 |  46571.4286 |     68428.5714 |
|     18 | customer service |  40000 |  46571.4286 |     68428.5714 |
|     19 | customer service |  31000 |  46571.4286 |     68428.5714 |
|     20 | customer service |  56000 |  46571.4286 |     68428.5714 |
|     21 | customer service |  55000 |  46571.4286 |     68428.5714 |
|      1 | engineering      |  80000 |  81285.7143 |     68428.5714 |
|      2 | engineering      |  69000 |  81285.7143 |     68428.5714 |
|      3 | engineering      |  70000 |  81285.7143 |     68428.5714 |
|      4 | engineering      | 103000 |  81285.7143 |     68428.5714 |
|      5 | engineering      |  67000 |  81285.7143 |     68428.5714 |
|      6 | engineering      |  89000 |  81285.7143 |     68428.5714 |
|      7 | engineering      |  91000 |  81285.7143 |     68428.5714 |
|      8 | sales            |  59000 |  77428.5714 |     68428.5714 |
|      9 | sales            |  70000 |  77428.5714 |     68428.5714 |
|     10 | sales            | 159000 |  77428.5714 |     68428.5714 |
|     11 | sales            |  72000 |  77428.5714 |     68428.5714 |
|     12 | sales            |  60000 |  77428.5714 |     68428.5714 |
|     13 | sales            |  61000 |  77428.5714 |     68428.5714 |
|     14 | sales            |  61000 |  77428.5714 |     68428.5714 |
+--------+------------------+--------+-------------+----------------+
21 rows in set (0.00 sec)

mysql> select emp_no,Salary,department,Avg(Salary) from employees group by department,emp_no,Salary;
+--------+--------+------------------+-------------+
| emp_no | Salary | department       | Avg(Salary) |
+--------+--------+------------------+-------------+
|      1 |  80000 | engineering      |  80000.0000 |
|      2 |  69000 | engineering      |  69000.0000 |
|      3 |  70000 | engineering      |  70000.0000 |
|      4 | 103000 | engineering      | 103000.0000 |
|      5 |  67000 | engineering      |  67000.0000 |
|      6 |  89000 | engineering      |  89000.0000 |
|      7 |  91000 | engineering      |  91000.0000 |
|      8 |  59000 | sales            |  59000.0000 |
|      9 |  70000 | sales            |  70000.0000 |
|     10 | 159000 | sales            | 159000.0000 |
|     11 |  72000 | sales            |  72000.0000 |
|     12 |  60000 | sales            |  60000.0000 |
|     13 |  61000 | sales            |  61000.0000 |
|     14 |  61000 | sales            |  61000.0000 |
|     15 |  38000 | customer service |  38000.0000 |
|     16 |  45000 | customer service |  45000.0000 |
|     17 |  61000 | customer service |  61000.0000 |
|     18 |  40000 | customer service |  40000.0000 |
|     19 |  31000 | customer service |  31000.0000 |
|     20 |  56000 | customer service |  56000.0000 |
|     21 |  55000 | customer service |  55000.0000 |
+--------+--------+------------------+-------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,Max(Salary) as Max_Salary,Min(Salary) as Min_Salary
    ->  from employees;
ERROR 1140 (42000): In aggregated query without GROUP BY, expression #1 of SELECT list contains nonaggregated column 'windowfunc.employees.emp_no'; this is incompatible with sql_mode=only_full_group_by
mysql> select  emp_no,Department,Salary,Max(Salary) over() as Max_Salary,Min(Salary) over() as Min_Salary  from employees;
+--------+------------------+--------+------------+------------+
| emp_no | Department       | Salary | Max_Salary | Min_Salary |
+--------+------------------+--------+------------+------------+
|      1 | engineering      |  80000 |     159000 |      31000 |
|      2 | engineering      |  69000 |     159000 |      31000 |
|      3 | engineering      |  70000 |     159000 |      31000 |
|      4 | engineering      | 103000 |     159000 |      31000 |
|      5 | engineering      |  67000 |     159000 |      31000 |
|      6 | engineering      |  89000 |     159000 |      31000 |
|      7 | engineering      |  91000 |     159000 |      31000 |
|      8 | sales            |  59000 |     159000 |      31000 |
|      9 | sales            |  70000 |     159000 |      31000 |
|     10 | sales            | 159000 |     159000 |      31000 |
|     11 | sales            |  72000 |     159000 |      31000 |
|     12 | sales            |  60000 |     159000 |      31000 |
|     13 | sales            |  61000 |     159000 |      31000 |
|     14 | sales            |  61000 |     159000 |      31000 |
|     15 | customer service |  38000 |     159000 |      31000 |
|     16 | customer service |  45000 |     159000 |      31000 |
|     17 | customer service |  61000 |     159000 |      31000 |
|     18 | customer service |  40000 |     159000 |      31000 |
|     19 | customer service |  31000 |     159000 |      31000 |
|     20 | customer service |  56000 |     159000 |      31000 |
|     21 | customer service |  55000 |     159000 |      31000 |
+--------+------------------+--------+------------+------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,Max(Salary) over(partition by department) as Max_Salary,Min(Salary) over(Partition by department) as Min_Salary  from employees;
+--------+------------------+--------+------------+------------+
| emp_no | Department       | Salary | Max_Salary | Min_Salary |
+--------+------------------+--------+------------+------------+
|     15 | customer service |  38000 |      61000 |      31000 |
|     16 | customer service |  45000 |      61000 |      31000 |
|     17 | customer service |  61000 |      61000 |      31000 |
|     18 | customer service |  40000 |      61000 |      31000 |
|     19 | customer service |  31000 |      61000 |      31000 |
|     20 | customer service |  56000 |      61000 |      31000 |
|     21 | customer service |  55000 |      61000 |      31000 |
|      1 | engineering      |  80000 |     103000 |      67000 |
|      2 | engineering      |  69000 |     103000 |      67000 |
|      3 | engineering      |  70000 |     103000 |      67000 |
|      4 | engineering      | 103000 |     103000 |      67000 |
|      5 | engineering      |  67000 |     103000 |      67000 |
|      6 | engineering      |  89000 |     103000 |      67000 |
|      7 | engineering      |  91000 |     103000 |      67000 |
|      8 | sales            |  59000 |     159000 |      59000 |
|      9 | sales            |  70000 |     159000 |      59000 |
|     10 | sales            | 159000 |     159000 |      59000 |
|     11 | sales            |  72000 |     159000 |      59000 |
|     12 | sales            |  60000 |     159000 |      59000 |
|     13 | sales            |  61000 |     159000 |      59000 |
|     14 | sales            |  61000 |     159000 |      59000 |
+--------+------------------+--------+------------+------------+
21 rows in set (0.00 sec)

mysql> select emp_no,
    -> department,salary,Avg(salary) over(Partition by department) as Dept_Payroll,Avg(Salary) over() as Total_Payroll from employees;
+--------+------------------+--------+--------------+---------------+
| emp_no | department       | salary | Dept_Payroll | Total_Payroll |
+--------+------------------+--------+--------------+---------------+
|     15 | customer service |  38000 |   46571.4286 |    68428.5714 |
|     16 | customer service |  45000 |   46571.4286 |    68428.5714 |
|     17 | customer service |  61000 |   46571.4286 |    68428.5714 |
|     18 | customer service |  40000 |   46571.4286 |    68428.5714 |
|     19 | customer service |  31000 |   46571.4286 |    68428.5714 |
|     20 | customer service |  56000 |   46571.4286 |    68428.5714 |
|     21 | customer service |  55000 |   46571.4286 |    68428.5714 |
|      1 | engineering      |  80000 |   81285.7143 |    68428.5714 |
|      2 | engineering      |  69000 |   81285.7143 |    68428.5714 |
|      3 | engineering      |  70000 |   81285.7143 |    68428.5714 |
|      4 | engineering      | 103000 |   81285.7143 |    68428.5714 |
|      5 | engineering      |  67000 |   81285.7143 |    68428.5714 |
|      6 | engineering      |  89000 |   81285.7143 |    68428.5714 |
|      7 | engineering      |  91000 |   81285.7143 |    68428.5714 |
|      8 | sales            |  59000 |   77428.5714 |    68428.5714 |
|      9 | sales            |  70000 |   77428.5714 |    68428.5714 |
|     10 | sales            | 159000 |   77428.5714 |    68428.5714 |
|     11 | sales            |  72000 |   77428.5714 |    68428.5714 |
|     12 | sales            |  60000 |   77428.5714 |    68428.5714 |
|     13 | sales            |  61000 |   77428.5714 |    68428.5714 |
|     14 | sales            |  61000 |   77428.5714 |    68428.5714 |
+--------+------------------+--------+--------------+---------------+
21 rows in set (0.01 sec)

mysql> select emp_no, department,salary,sum(salary) over(Partition by department) as Dept_Payroll,sum(Salary) over() as Total_Payroll 
+--------+------------------+--------+--------------+---------------+
| emp_no | department       | salary | Dept_Payroll | Total_Payroll |
+--------+------------------+--------+--------------+---------------+
|     15 | customer service |  38000 |       326000 |       1437000 |
|     16 | customer service |  45000 |       326000 |       1437000 |
|     17 | customer service |  61000 |       326000 |       1437000 |
|     18 | customer service |  40000 |       326000 |       1437000 |
|     19 | customer service |  31000 |       326000 |       1437000 |
|     20 | customer service |  56000 |       326000 |       1437000 |
|     21 | customer service |  55000 |       326000 |       1437000 |
|      1 | engineering      |  80000 |       569000 |       1437000 |
|      2 | engineering      |  69000 |       569000 |       1437000 |
|      3 | engineering      |  70000 |       569000 |       1437000 |
|      4 | engineering      | 103000 |       569000 |       1437000 |
|      5 | engineering      |  67000 |       569000 |       1437000 |
|      6 | engineering      |  89000 |       569000 |       1437000 |
|      7 | engineering      |  91000 |       569000 |       1437000 |
|      8 | sales            |  59000 |       542000 |       1437000 |
|      9 | sales            |  70000 |       542000 |       1437000 |
|     10 | sales            | 159000 |       542000 |       1437000 |
|     11 | sales            |  72000 |       542000 |       1437000 |
|     12 | sales            |  60000 |       542000 |       1437000 |
|     13 | sales            |  61000 |       542000 |       1437000 |
|     14 | sales            |  61000 |       542000 |       1437000 |
+--------+------------------+--------+--------------+---------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> sum(Salary) over(partition by department order by Salary desc) as Max_Salary,
    -> sum(Salary) over(Partition by department) as witout_ord
    -> from employees; 
+--------+------------------+--------+------------+------------+
| emp_no | Department       | Salary | Max_Salary | witout_ord |
+--------+------------------+--------+------------+------------+
|     17 | customer service |  61000 |      61000 |     326000 |
|     20 | customer service |  56000 |     117000 |     326000 |
|     21 | customer service |  55000 |     172000 |     326000 |
|     16 | customer service |  45000 |     217000 |     326000 |
|     18 | customer service |  40000 |     257000 |     326000 |
|     15 | customer service |  38000 |     295000 |     326000 |
|     19 | customer service |  31000 |     326000 |     326000 |
|      4 | engineering      | 103000 |     103000 |     569000 |
|      7 | engineering      |  91000 |     194000 |     569000 |
|      6 | engineering      |  89000 |     283000 |     569000 |
|      1 | engineering      |  80000 |     363000 |     569000 |
|      3 | engineering      |  70000 |     433000 |     569000 |
|      2 | engineering      |  69000 |     502000 |     569000 |
|      5 | engineering      |  67000 |     569000 |     569000 |
|     10 | sales            | 159000 |     159000 |     542000 |
|     11 | sales            |  72000 |     231000 |     542000 |
|      9 | sales            |  70000 |     301000 |     542000 |
|     13 | sales            |  61000 |     423000 |     542000 |
|     14 | sales            |  61000 |     423000 |     542000 |
|     12 | sales            |  60000 |     483000 |     542000 |
|      8 | sales            |  59000 |     542000 |     542000 |
+--------+------------------+--------+------------+------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary, sum(Salary) over(partition by department order by Salary desc) as Max_Salary, sum(Salary) over(Partition by department) as witout_ord from employees;
+--------+------------------+--------+------------+------------+
| emp_no | Department       | Salary | Max_Salary | witout_ord |
+--------+------------------+--------+------------+------------+
|     17 | customer service |  61000 |      61000 |     326000 |
|     20 | customer service |  56000 |     117000 |     326000 |
|     21 | customer service |  55000 |     172000 |     326000 |
|     16 | customer service |  45000 |     217000 |     326000 |
|     18 | customer service |  40000 |     257000 |     326000 |
|     15 | customer service |  38000 |     295000 |     326000 |
|     19 | customer service |  31000 |     326000 |     326000 |
|      4 | engineering      | 103000 |     103000 |     569000 |
|      7 | engineering      |  91000 |     194000 |     569000 |
|      6 | engineering      |  89000 |     283000 |     569000 |
|      1 | engineering      |  80000 |     363000 |     569000 |
|      3 | engineering      |  70000 |     433000 |     569000 |
|      2 | engineering      |  69000 |     502000 |     569000 |
|      5 | engineering      |  67000 |     569000 |     569000 |
|     10 | sales            | 159000 |     159000 |     542000 |
|     11 | sales            |  72000 |     231000 |     542000 |
|      9 | sales            |  70000 |     301000 |     542000 |
|     13 | sales            |  61000 |     423000 |     542000 |
|     14 | sales            |  61000 |     423000 |     542000 |
|     12 | sales            |  60000 |     483000 |     542000 |
|      8 | sales            |  59000 |     542000 |     542000 |
+--------+------------------+--------+------------+------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> sum(Salary) over(partition by department order by Salary asc) as Max_Salary,
    -> sum(Salary) over(Partition by department) as witout_ord
    -> from employees; 
+--------+------------------+--------+------------+------------+
| emp_no | Department       | Salary | Max_Salary | witout_ord |
+--------+------------------+--------+------------+------------+
|     19 | customer service |  31000 |      31000 |     326000 |
|     15 | customer service |  38000 |      69000 |     326000 |
|     18 | customer service |  40000 |     109000 |     326000 |
|     16 | customer service |  45000 |     154000 |     326000 |
|     21 | customer service |  55000 |     209000 |     326000 |
|     20 | customer service |  56000 |     265000 |     326000 |
|     17 | customer service |  61000 |     326000 |     326000 |
|      5 | engineering      |  67000 |      67000 |     569000 |
|      2 | engineering      |  69000 |     136000 |     569000 |
|      3 | engineering      |  70000 |     206000 |     569000 |
|      1 | engineering      |  80000 |     286000 |     569000 |
|      6 | engineering      |  89000 |     375000 |     569000 |
|      7 | engineering      |  91000 |     466000 |     569000 |
|      4 | engineering      | 103000 |     569000 |     569000 |
|      8 | sales            |  59000 |      59000 |     542000 |
|     12 | sales            |  60000 |     119000 |     542000 |
|     13 | sales            |  61000 |     241000 |     542000 |
|     14 | sales            |  61000 |     241000 |     542000 |
|      9 | sales            |  70000 |     311000 |     542000 |
|     11 | sales            |  72000 |     383000 |     542000 |
|     10 | sales            | 159000 |     542000 |     542000 |
+--------+------------------+--------+------------+------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Rank() over(partition by department order by Salary desc) as dept_Salary_Rank,
    -> Rank() over(order by salary desc) as overall_Salary_Rank
    -> from employees; 
+--------+------------------+--------+------------------+---------------------+
| emp_no | Department       | Salary | dept_Salary_Rank | overall_Salary_Rank |
+--------+------------------+--------+------------------+---------------------+
|     10 | sales            | 159000 |                1 |                   1 |
|      4 | engineering      | 103000 |                1 |                   2 |
|      7 | engineering      |  91000 |                2 |                   3 |
|      6 | engineering      |  89000 |                3 |                   4 |
|      1 | engineering      |  80000 |                4 |                   5 |
|     11 | sales            |  72000 |                2 |                   6 |
|      3 | engineering      |  70000 |                5 |                   7 |
|      9 | sales            |  70000 |                3 |                   7 |
|      2 | engineering      |  69000 |                6 |                   9 |
|      5 | engineering      |  67000 |                7 |                  10 |
|     17 | customer service |  61000 |                1 |                  11 |
|     13 | sales            |  61000 |                4 |                  11 |
|     14 | sales            |  61000 |                4 |                  11 |
|     12 | sales            |  60000 |                6 |                  14 |
|      8 | sales            |  59000 |                7 |                  15 |
|     20 | customer service |  56000 |                2 |                  16 |
|     21 | customer service |  55000 |                3 |                  17 |
|     16 | customer service |  45000 |                4 |                  18 |
|     18 | customer service |  40000 |                5 |                  19 |
|     15 | customer service |  38000 |                6 |                  20 |
|     19 | customer service |  31000 |                7 |                  21 |
+--------+------------------+--------+------------------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary, Rank() over(partition by department order by Salary desc) as dept_Salary_Rank, Rank() over(order by salary desc) as overall_Salary_Rank from employees;
+--------+------------------+--------+------------------+---------------------+
| emp_no | Department       | Salary | dept_Salary_Rank | overall_Salary_Rank |
+--------+------------------+--------+------------------+---------------------+
|     10 | sales            | 159000 |                1 |                   1 |
|      4 | engineering      | 103000 |                1 |                   2 |
|      7 | engineering      |  91000 |                2 |                   3 |
|      6 | engineering      |  89000 |                3 |                   4 |
|      1 | engineering      |  80000 |                4 |                   5 |
|     11 | sales            |  72000 |                2 |                   6 |
|      3 | engineering      |  70000 |                5 |                   7 |
|      9 | sales            |  70000 |                3 |                   7 |
|      2 | engineering      |  69000 |                6 |                   9 |
|      5 | engineering      |  67000 |                7 |                  10 |
|     17 | customer service |  61000 |                1 |                  11 |
|     13 | sales            |  61000 |                4 |                  11 |
|     14 | sales            |  61000 |                4 |                  11 |
|     12 | sales            |  60000 |                6 |                  14 |
|      8 | sales            |  59000 |                7 |                  15 |
|     20 | customer service |  56000 |                2 |                  16 |
|     21 | customer service |  55000 |                3 |                  17 |
|     16 | customer service |  45000 |                4 |                  18 |
|     18 | customer service |  40000 |                5 |                  19 |
|     15 | customer service |  38000 |                6 |                  20 |
|     19 | customer service |  31000 |                7 |                  21 |
+--------+------------------+--------+------------------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Rank() over(partition by department order by Salary asc) as dept_Salary_Rank,
    -> Rank() over(order by salary asc) as overall_Salary_Rank
    -> from employees; 
+--------+------------------+--------+------------------+---------------------+
| emp_no | Department       | Salary | dept_Salary_Rank | overall_Salary_Rank |
+--------+------------------+--------+------------------+---------------------+
|     19 | customer service |  31000 |                1 |                   1 |
|     15 | customer service |  38000 |                2 |                   2 |
|     18 | customer service |  40000 |                3 |                   3 |
|     16 | customer service |  45000 |                4 |                   4 |
|     21 | customer service |  55000 |                5 |                   5 |
|     20 | customer service |  56000 |                6 |                   6 |
|      8 | sales            |  59000 |                1 |                   7 |
|     12 | sales            |  60000 |                2 |                   8 |
|     17 | customer service |  61000 |                7 |                   9 |
|     13 | sales            |  61000 |                3 |                   9 |
|     14 | sales            |  61000 |                3 |                   9 |
|      5 | engineering      |  67000 |                1 |                  12 |
|      2 | engineering      |  69000 |                2 |                  13 |
|      3 | engineering      |  70000 |                3 |                  14 |
|      9 | sales            |  70000 |                5 |                  14 |
|     11 | sales            |  72000 |                6 |                  16 |
|      1 | engineering      |  80000 |                4 |                  17 |
|      6 | engineering      |  89000 |                5 |                  18 |
|      7 | engineering      |  91000 |                6 |                  19 |
|      4 | engineering      | 103000 |                7 |                  20 |
|     10 | sales            | 159000 |                7 |                  21 |
+--------+------------------+--------+------------------+---------------------+
21 rows in set (0.00 sec)

mysql> Rank() over(partition by department order by Salary asc) as dept_Salary_Rank,
    -> Ã§^C
mysql> Rank() over(partition by department order by Salary asc) as dept_Salary_Rank,
    -> ^C
mysql> select  emp_no,Department,Salary,
    -> Rank() over(partition by department order by Salary asc) as dept_Salary_Rank,
    -> Rank() over(order by salary asc) as overall_Salary_Rank
    -> from employees
    -> order by department; 
+--------+------------------+--------+------------------+---------------------+
| emp_no | Department       | Salary | dept_Salary_Rank | overall_Salary_Rank |
+--------+------------------+--------+------------------+---------------------+
|     19 | customer service |  31000 |                1 |                   1 |
|     15 | customer service |  38000 |                2 |                   2 |
|     18 | customer service |  40000 |                3 |                   3 |
|     16 | customer service |  45000 |                4 |                   4 |
|     21 | customer service |  55000 |                5 |                   5 |
|     20 | customer service |  56000 |                6 |                   6 |
|     17 | customer service |  61000 |                7 |                   9 |
|      5 | engineering      |  67000 |                1 |                  12 |
|      2 | engineering      |  69000 |                2 |                  13 |
|      3 | engineering      |  70000 |                3 |                  14 |
|      1 | engineering      |  80000 |                4 |                  17 |
|      6 | engineering      |  89000 |                5 |                  18 |
|      7 | engineering      |  91000 |                6 |                  19 |
|      4 | engineering      | 103000 |                7 |                  20 |
|      8 | sales            |  59000 |                1 |                   7 |
|     12 | sales            |  60000 |                2 |                   8 |
|     13 | sales            |  61000 |                3 |                   9 |
|     14 | sales            |  61000 |                3 |                   9 |
|      9 | sales            |  70000 |                5 |                  14 |
|     11 | sales            |  72000 |                6 |                  16 |
|     10 | sales            | 159000 |                7 |                  21 |
+--------+------------------+--------+------------------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary, Rank() over(partition by department order by Salary asc) as dept_Salary_Rank, Rank() over(order by salary asc) as overall_Salary_Rank from employees order by department;
+--------+------------------+--------+------------------+---------------------+
| emp_no | Department       | Salary | dept_Salary_Rank | overall_Salary_Rank |
+--------+------------------+--------+------------------+---------------------+
|     19 | customer service |  31000 |                1 |                   1 |
|     15 | customer service |  38000 |                2 |                   2 |
|     18 | customer service |  40000 |                3 |                   3 |
|     16 | customer service |  45000 |                4 |                   4 |
|     21 | customer service |  55000 |                5 |                   5 |
|     20 | customer service |  56000 |                6 |                   6 |
|     17 | customer service |  61000 |                7 |                   9 |
|      5 | engineering      |  67000 |                1 |                  12 |
|      2 | engineering      |  69000 |                2 |                  13 |
|      3 | engineering      |  70000 |                3 |                  14 |
|      1 | engineering      |  80000 |                4 |                  17 |
|      6 | engineering      |  89000 |                5 |                  18 |
|      7 | engineering      |  91000 |                6 |                  19 |
|      4 | engineering      | 103000 |                7 |                  20 |
|      8 | sales            |  59000 |                1 |                   7 |
|     12 | sales            |  60000 |                2 |                   8 |
|     13 | sales            |  61000 |                3 |                   9 |
|     14 | sales            |  61000 |                3 |                   9 |
|      9 | sales            |  70000 |                5 |                  14 |
|     11 | sales            |  72000 |                6 |                  16 |
|     10 | sales            | 159000 |                7 |                  21 |
+--------+------------------+--------+------------------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Row_Number() over(partition by department order by Salary desc) as Row_Number_Salary,
    -> Rank() over(partition by department order by Salary desc) as dept_Salary_Rank,
    -> Rank() over(order by salary desc) as overall_Salary_Rank
    -> from employees;
+--------+------------------+--------+-------------------+------------------+---------------------+
| emp_no | Department       | Salary | Row_Number_Salary | dept_Salary_Rank | overall_Salary_Rank |
+--------+------------------+--------+-------------------+------------------+---------------------+
|     10 | sales            | 159000 |                 1 |                1 |                   1 |
|      4 | engineering      | 103000 |                 1 |                1 |                   2 |
|      7 | engineering      |  91000 |                 2 |                2 |                   3 |
|      6 | engineering      |  89000 |                 3 |                3 |                   4 |
|      1 | engineering      |  80000 |                 4 |                4 |                   5 |
|     11 | sales            |  72000 |                 2 |                2 |                   6 |
|      3 | engineering      |  70000 |                 5 |                5 |                   7 |
|      9 | sales            |  70000 |                 3 |                3 |                   7 |
|      2 | engineering      |  69000 |                 6 |                6 |                   9 |
|      5 | engineering      |  67000 |                 7 |                7 |                  10 |
|     17 | customer service |  61000 |                 1 |                1 |                  11 |
|     13 | sales            |  61000 |                 4 |                4 |                  11 |
|     14 | sales            |  61000 |                 5 |                4 |                  11 |
|     12 | sales            |  60000 |                 6 |                6 |                  14 |
|      8 | sales            |  59000 |                 7 |                7 |                  15 |
|     20 | customer service |  56000 |                 2 |                2 |                  16 |
|     21 | customer service |  55000 |                 3 |                3 |                  17 |
|     16 | customer service |  45000 |                 4 |                4 |                  18 |
|     18 | customer service |  40000 |                 5 |                5 |                  19 |
|     15 | customer service |  38000 |                 6 |                6 |                  20 |
|     19 | customer service |  31000 |                 7 |                7 |                  21 |
+--------+------------------+--------+-------------------+------------------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary, Row_Number() over(partition by department order by Salary desc) as Row_Number_Salary, Rank() over(partition by department order by Salary desc) as dept_Salary_Rank, Rank() over(order by salary desc) as overall_Salary_Rank from employees;
+--------+------------------+--------+-------------------+------------------+---------------------+
| emp_no | Department       | Salary | Row_Number_Salary | dept_Salary_Rank | overall_Salary_Rank |
+--------+------------------+--------+-------------------+------------------+---------------------+
|     10 | sales            | 159000 |                 1 |                1 |                   1 |
|      4 | engineering      | 103000 |                 1 |                1 |                   2 |
|      7 | engineering      |  91000 |                 2 |                2 |                   3 |
|      6 | engineering      |  89000 |                 3 |                3 |                   4 |
|      1 | engineering      |  80000 |                 4 |                4 |                   5 |
|     11 | sales            |  72000 |                 2 |                2 |                   6 |
|      3 | engineering      |  70000 |                 5 |                5 |                   7 |
|      9 | sales            |  70000 |                 3 |                3 |                   7 |
|      2 | engineering      |  69000 |                 6 |                6 |                   9 |
|      5 | engineering      |  67000 |                 7 |                7 |                  10 |
|     17 | customer service |  61000 |                 1 |                1 |                  11 |
|     13 | sales            |  61000 |                 4 |                4 |                  11 |
|     14 | sales            |  61000 |                 5 |                4 |                  11 |
|     12 | sales            |  60000 |                 6 |                6 |                  14 |
|      8 | sales            |  59000 |                 7 |                7 |                  15 |
|     20 | customer service |  56000 |                 2 |                2 |                  16 |
|     21 | customer service |  55000 |                 3 |                3 |                  17 |
|     16 | customer service |  45000 |                 4 |                4 |                  18 |
|     18 | customer service |  40000 |                 5 |                5 |                  19 |
|     15 | customer service |  38000 |                 6 |                6 |                  20 |
|     19 | customer service |  31000 |                 7 |                7 |                  21 |
+--------+------------------+--------+-------------------+------------------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Row_Number() over(partition by department order by Salary desc) as Row_Number_Salary,
    -> Rank() over(partition by department order by Salary desc) as dept_Salary_Rank,
    -> Row_Number() over(order by salary desc) as overall_Salary_Rank
    -> from employees;
+--------+------------------+--------+-------------------+------------------+---------------------+
| emp_no | Department       | Salary | Row_Number_Salary | dept_Salary_Rank | overall_Salary_Rank |
+--------+------------------+--------+-------------------+------------------+---------------------+
|     10 | sales            | 159000 |                 1 |                1 |                   1 |
|      4 | engineering      | 103000 |                 1 |                1 |                   2 |
|      7 | engineering      |  91000 |                 2 |                2 |                   3 |
|      6 | engineering      |  89000 |                 3 |                3 |                   4 |
|      1 | engineering      |  80000 |                 4 |                4 |                   5 |
|     11 | sales            |  72000 |                 2 |                2 |                   6 |
|      3 | engineering      |  70000 |                 5 |                5 |                   7 |
|      9 | sales            |  70000 |                 3 |                3 |                   8 |
|      2 | engineering      |  69000 |                 6 |                6 |                   9 |
|      5 | engineering      |  67000 |                 7 |                7 |                  10 |
|     17 | customer service |  61000 |                 1 |                1 |                  11 |
|     13 | sales            |  61000 |                 4 |                4 |                  12 |
|     14 | sales            |  61000 |                 5 |                4 |                  13 |
|     12 | sales            |  60000 |                 6 |                6 |                  14 |
|      8 | sales            |  59000 |                 7 |                7 |                  15 |
|     20 | customer service |  56000 |                 2 |                2 |                  16 |
|     21 | customer service |  55000 |                 3 |                3 |                  17 |
|     16 | customer service |  45000 |                 4 |                4 |                  18 |
|     18 | customer service |  40000 |                 5 |                5 |                  19 |
|     15 | customer service |  38000 |                 6 |                6 |                  20 |
|     19 | customer service |  31000 |                 7 |                7 |                  21 |
+--------+------------------+--------+-------------------+------------------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Rank() over(partition by department order by Salary desc) as Row_Number_Salary,
    -> Rank() over(partition by department order by Salary desc) as dept_Salary_Rank,
    -> Row_Number() over(order by salary desc) as overall_Salary_Rank
    -> from employees;
+--------+------------------+--------+-------------------+------------------+---------------------+
| emp_no | Department       | Salary | Row_Number_Salary | dept_Salary_Rank | overall_Salary_Rank |
+--------+------------------+--------+-------------------+------------------+---------------------+
|     10 | sales            | 159000 |                 1 |                1 |                   1 |
|      4 | engineering      | 103000 |                 1 |                1 |                   2 |
|      7 | engineering      |  91000 |                 2 |                2 |                   3 |
|      6 | engineering      |  89000 |                 3 |                3 |                   4 |
|      1 | engineering      |  80000 |                 4 |                4 |                   5 |
|     11 | sales            |  72000 |                 2 |                2 |                   6 |
|      3 | engineering      |  70000 |                 5 |                5 |                   7 |
|      9 | sales            |  70000 |                 3 |                3 |                   8 |
|      2 | engineering      |  69000 |                 6 |                6 |                   9 |
|      5 | engineering      |  67000 |                 7 |                7 |                  10 |
|     17 | customer service |  61000 |                 1 |                1 |                  11 |
|     13 | sales            |  61000 |                 4 |                4 |                  12 |
|     14 | sales            |  61000 |                 4 |                4 |                  13 |
|     12 | sales            |  60000 |                 6 |                6 |                  14 |
|      8 | sales            |  59000 |                 7 |                7 |                  15 |
|     20 | customer service |  56000 |                 2 |                2 |                  16 |
|     21 | customer service |  55000 |                 3 |                3 |                  17 |
|     16 | customer service |  45000 |                 4 |                4 |                  18 |
|     18 | customer service |  40000 |                 5 |                5 |                  19 |
|     15 | customer service |  38000 |                 6 |                6 |                  20 |
|     19 | customer service |  31000 |                 7 |                7 |                  21 |
+--------+------------------+--------+-------------------+------------------+---------------------+
21 rows in set (0.00 sec)

mysql> 
mysql> select  emp_no,Department,Salary,
    -> Row_Number() over(partition by department order by Salary desc) as Row_Number_Salary,
    -> Rank() over(partition by department order by Salary desc) as dept_Salary_Rank,
    -> Row_Number() over(order by salary desc) as overall_Salary_Rank
    -> from employees;
+--------+------------------+--------+-------------------+------------------+---------------------+
| emp_no | Department       | Salary | Row_Number_Salary | dept_Salary_Rank | overall_Salary_Rank |
+--------+------------------+--------+-------------------+------------------+---------------------+
|     10 | sales            | 159000 |                 1 |                1 |                   1 |
|      4 | engineering      | 103000 |                 1 |                1 |                   2 |
|      7 | engineering      |  91000 |                 2 |                2 |                   3 |
|      6 | engineering      |  89000 |                 3 |                3 |                   4 |
|      1 | engineering      |  80000 |                 4 |                4 |                   5 |
|     11 | sales            |  72000 |                 2 |                2 |                   6 |
|      3 | engineering      |  70000 |                 5 |                5 |                   7 |
|      9 | sales            |  70000 |                 3 |                3 |                   8 |
|      2 | engineering      |  69000 |                 6 |                6 |                   9 |
|      5 | engineering      |  67000 |                 7 |                7 |                  10 |
|     17 | customer service |  61000 |                 1 |                1 |                  11 |
|     13 | sales            |  61000 |                 4 |                4 |                  12 |
|     14 | sales            |  61000 |                 5 |                4 |                  13 |
|     12 | sales            |  60000 |                 6 |                6 |                  14 |
|      8 | sales            |  59000 |                 7 |                7 |                  15 |
|     20 | customer service |  56000 |                 2 |                2 |                  16 |
|     21 | customer service |  55000 |                 3 |                3 |                  17 |
|     16 | customer service |  45000 |                 4 |                4 |                  18 |
|     18 | customer service |  40000 |                 5 |                5 |                  19 |
|     15 | customer service |  38000 |                 6 |                6 |                  20 |
|     19 | customer service |  31000 |                 7 |                7 |                  21 |
+--------+------------------+--------+-------------------+------------------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary, Row_Number() over(partition by department order by Salary desc) as Row_Number_Salary, Rank() over(partition by department order by Salary desc) as dept_Salary_Rank, Row_Number() over(order by salary desc) as overall_Salary_Rank from employees;
+--------+------------------+--------+-------------------+------------------+---------------------+
| emp_no | Department       | Salary | Row_Number_Salary | dept_Salary_Rank | overall_Salary_Rank |
+--------+------------------+--------+-------------------+------------------+---------------------+
|     10 | sales            | 159000 |                 1 |                1 |                   1 |
|      4 | engineering      | 103000 |                 1 |                1 |                   2 |
|      7 | engineering      |  91000 |                 2 |                2 |                   3 |
|      6 | engineering      |  89000 |                 3 |                3 |                   4 |
|      1 | engineering      |  80000 |                 4 |                4 |                   5 |
|     11 | sales            |  72000 |                 2 |                2 |                   6 |
|      3 | engineering      |  70000 |                 5 |                5 |                   7 |
|      9 | sales            |  70000 |                 3 |                3 |                   8 |
|      2 | engineering      |  69000 |                 6 |                6 |                   9 |
|      5 | engineering      |  67000 |                 7 |                7 |                  10 |
|     17 | customer service |  61000 |                 1 |                1 |                  11 |
|     13 | sales            |  61000 |                 4 |                4 |                  12 |
|     14 | sales            |  61000 |                 5 |                4 |                  13 |
|     12 | sales            |  60000 |                 6 |                6 |                  14 |
|      8 | sales            |  59000 |                 7 |                7 |                  15 |
|     20 | customer service |  56000 |                 2 |                2 |                  16 |
|     21 | customer service |  55000 |                 3 |                3 |                  17 |
|     16 | customer service |  45000 |                 4 |                4 |                  18 |
|     18 | customer service |  40000 |                 5 |                5 |                  19 |
|     15 | customer service |  38000 |                 6 |                6 |                  20 |
|     19 | customer service |  31000 |                 7 |                7 |                  21 |
+--------+------------------+--------+-------------------+------------------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Row_Number() over(partition by department order by Salary desc) as Row_Number_Salary,
    -> Rank() over(partition by department order by Salary desc) as dept_Salary_Rank,
    -> Rank() over(order by salary desc) as overall_Salary_Rank
    -> from employees;
+--------+------------------+--------+-------------------+------------------+---------------------+
| emp_no | Department       | Salary | Row_Number_Salary | dept_Salary_Rank | overall_Salary_Rank |
+--------+------------------+--------+-------------------+------------------+---------------------+
|     10 | sales            | 159000 |                 1 |                1 |                   1 |
|      4 | engineering      | 103000 |                 1 |                1 |                   2 |
|      7 | engineering      |  91000 |                 2 |                2 |                   3 |
|      6 | engineering      |  89000 |                 3 |                3 |                   4 |
|      1 | engineering      |  80000 |                 4 |                4 |                   5 |
|     11 | sales            |  72000 |                 2 |                2 |                   6 |
|      3 | engineering      |  70000 |                 5 |                5 |                   7 |
|      9 | sales            |  70000 |                 3 |                3 |                   7 |
|      2 | engineering      |  69000 |                 6 |                6 |                   9 |
|      5 | engineering      |  67000 |                 7 |                7 |                  10 |
|     17 | customer service |  61000 |                 1 |                1 |                  11 |
|     13 | sales            |  61000 |                 4 |                4 |                  11 |
|     14 | sales            |  61000 |                 5 |                4 |                  11 |
|     12 | sales            |  60000 |                 6 |                6 |                  14 |
|      8 | sales            |  59000 |                 7 |                7 |                  15 |
|     20 | customer service |  56000 |                 2 |                2 |                  16 |
|     21 | customer service |  55000 |                 3 |                3 |                  17 |
|     16 | customer service |  45000 |                 4 |                4 |                  18 |
|     18 | customer service |  40000 |                 5 |                5 |                  19 |
|     15 | customer service |  38000 |                 6 |                6 |                  20 |
|     19 | customer service |  31000 |                 7 |                7 |                  21 |
+--------+------------------+--------+-------------------+------------------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Rank() over(partition by department order by Salary desc) as dept_Salary_Rank,
    -> Rank() over(order by salary desc) as overall_Salary_Rank
    -> from employees;
+--------+------------------+--------+------------------+---------------------+
| emp_no | Department       | Salary | dept_Salary_Rank | overall_Salary_Rank |
+--------+------------------+--------+------------------+---------------------+
|     10 | sales            | 159000 |                1 |                   1 |
|      4 | engineering      | 103000 |                1 |                   2 |
|      7 | engineering      |  91000 |                2 |                   3 |
|      6 | engineering      |  89000 |                3 |                   4 |
|      1 | engineering      |  80000 |                4 |                   5 |
|     11 | sales            |  72000 |                2 |                   6 |
|      3 | engineering      |  70000 |                5 |                   7 |
|      9 | sales            |  70000 |                3 |                   7 |
|      2 | engineering      |  69000 |                6 |                   9 |
|      5 | engineering      |  67000 |                7 |                  10 |
|     17 | customer service |  61000 |                1 |                  11 |
|     13 | sales            |  61000 |                4 |                  11 |
|     14 | sales            |  61000 |                4 |                  11 |
|     12 | sales            |  60000 |                6 |                  14 |
|      8 | sales            |  59000 |                7 |                  15 |
|     20 | customer service |  56000 |                2 |                  16 |
|     21 | customer service |  55000 |                3 |                  17 |
|     16 | customer service |  45000 |                4 |                  18 |
|     18 | customer service |  40000 |                5 |                  19 |
|     15 | customer service |  38000 |                6 |                  20 |
|     19 | customer service |  31000 |                7 |                  21 |
+--------+------------------+--------+------------------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Rank() over(partition by department order by Salary desc) as dept_Salary_Rank,
    -> Row_Number() over(order by salary desc) as overall_Salary_Rank
    -> from employees;
+--------+------------------+--------+------------------+---------------------+
| emp_no | Department       | Salary | dept_Salary_Rank | overall_Salary_Rank |
+--------+------------------+--------+------------------+---------------------+
|     10 | sales            | 159000 |                1 |                   1 |
|      4 | engineering      | 103000 |                1 |                   2 |
|      7 | engineering      |  91000 |                2 |                   3 |
|      6 | engineering      |  89000 |                3 |                   4 |
|      1 | engineering      |  80000 |                4 |                   5 |
|     11 | sales            |  72000 |                2 |                   6 |
|      3 | engineering      |  70000 |                5 |                   7 |
|      9 | sales            |  70000 |                3 |                   8 |
|      2 | engineering      |  69000 |                6 |                   9 |
|      5 | engineering      |  67000 |                7 |                  10 |
|     17 | customer service |  61000 |                1 |                  11 |
|     13 | sales            |  61000 |                4 |                  12 |
|     14 | sales            |  61000 |                4 |                  13 |
|     12 | sales            |  60000 |                6 |                  14 |
|      8 | sales            |  59000 |                7 |                  15 |
|     20 | customer service |  56000 |                2 |                  16 |
|     21 | customer service |  55000 |                3 |                  17 |
|     16 | customer service |  45000 |                4 |                  18 |
|     18 | customer service |  40000 |                5 |                  19 |
|     15 | customer service |  38000 |                6 |                  20 |
|     19 | customer service |  31000 |                7 |                  21 |
+--------+------------------+--------+------------------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary, Rank() over(partition by department order by Salary desc) as dept_Salary_Rank, Row_Number() over(order by salary desc) as overall_Salary_Rank from employees;
+--------+------------------+--------+------------------+---------------------+
| emp_no | Department       | Salary | dept_Salary_Rank | overall_Salary_Rank |
+--------+------------------+--------+------------------+---------------------+
|     10 | sales            | 159000 |                1 |                   1 |
|      4 | engineering      | 103000 |                1 |                   2 |
|      7 | engineering      |  91000 |                2 |                   3 |
|      6 | engineering      |  89000 |                3 |                   4 |
|      1 | engineering      |  80000 |                4 |                   5 |
|     11 | sales            |  72000 |                2 |                   6 |
|      3 | engineering      |  70000 |                5 |                   7 |
|      9 | sales            |  70000 |                3 |                   8 |
|      2 | engineering      |  69000 |                6 |                   9 |
|      5 | engineering      |  67000 |                7 |                  10 |
|     17 | customer service |  61000 |                1 |                  11 |
|     13 | sales            |  61000 |                4 |                  12 |
|     14 | sales            |  61000 |                4 |                  13 |
|     12 | sales            |  60000 |                6 |                  14 |
|      8 | sales            |  59000 |                7 |                  15 |
|     20 | customer service |  56000 |                2 |                  16 |
|     21 | customer service |  55000 |                3 |                  17 |
|     16 | customer service |  45000 |                4 |                  18 |
|     18 | customer service |  40000 |                5 |                  19 |
|     15 | customer service |  38000 |                6 |                  20 |
|     19 | customer service |  31000 |                7 |                  21 |
+--------+------------------+--------+------------------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Rank() over(partition by department order by Salary desc) as dept_Salary_Rank,
    -> Rank() over(order by salary desc) as overall_Salary_Rank
    -> from employees;
+--------+------------------+--------+------------------+---------------------+
| emp_no | Department       | Salary | dept_Salary_Rank | overall_Salary_Rank |
+--------+------------------+--------+------------------+---------------------+
|     10 | sales            | 159000 |                1 |                   1 |
|      4 | engineering      | 103000 |                1 |                   2 |
|      7 | engineering      |  91000 |                2 |                   3 |
|      6 | engineering      |  89000 |                3 |                   4 |
|      1 | engineering      |  80000 |                4 |                   5 |
|     11 | sales            |  72000 |                2 |                   6 |
|      3 | engineering      |  70000 |                5 |                   7 |
|      9 | sales            |  70000 |                3 |                   7 |
|      2 | engineering      |  69000 |                6 |                   9 |
|      5 | engineering      |  67000 |                7 |                  10 |
|     17 | customer service |  61000 |                1 |                  11 |
|     13 | sales            |  61000 |                4 |                  11 |
|     14 | sales            |  61000 |                4 |                  11 |
|     12 | sales            |  60000 |                6 |                  14 |
|      8 | sales            |  59000 |                7 |                  15 |
|     20 | customer service |  56000 |                2 |                  16 |
|     21 | customer service |  55000 |                3 |                  17 |
|     16 | customer service |  45000 |                4 |                  18 |
|     18 | customer service |  40000 |                5 |                  19 |
|     15 | customer service |  38000 |                6 |                  20 |
|     19 | customer service |  31000 |                7 |                  21 |
+--------+------------------+--------+------------------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Row_Number() over(partition by department order by Salary desc) as dept_Salary_Rank,
    -> Rank() over(order by salary desc) as overall_Salary_Rank
    -> from employees;
+--------+------------------+--------+------------------+---------------------+
| emp_no | Department       | Salary | dept_Salary_Rank | overall_Salary_Rank |
+--------+------------------+--------+------------------+---------------------+
|     10 | sales            | 159000 |                1 |                   1 |
|      4 | engineering      | 103000 |                1 |                   2 |
|      7 | engineering      |  91000 |                2 |                   3 |
|      6 | engineering      |  89000 |                3 |                   4 |
|      1 | engineering      |  80000 |                4 |                   5 |
|     11 | sales            |  72000 |                2 |                   6 |
|      3 | engineering      |  70000 |                5 |                   7 |
|      9 | sales            |  70000 |                3 |                   7 |
|      2 | engineering      |  69000 |                6 |                   9 |
|      5 | engineering      |  67000 |                7 |                  10 |
|     17 | customer service |  61000 |                1 |                  11 |
|     13 | sales            |  61000 |                4 |                  11 |
|     14 | sales            |  61000 |                5 |                  11 |
|     12 | sales            |  60000 |                6 |                  14 |
|      8 | sales            |  59000 |                7 |                  15 |
|     20 | customer service |  56000 |                2 |                  16 |
|     21 | customer service |  55000 |                3 |                  17 |
|     16 | customer service |  45000 |                4 |                  18 |
|     18 | customer service |  40000 |                5 |                  19 |
|     15 | customer service |  38000 |                6 |                  20 |
|     19 | customer service |  31000 |                7 |                  21 |
+--------+------------------+--------+------------------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Row_Number() over(partition by department order by Salary desc) as dept_Salary_Rank,
    -> Rank() over(order by salary desc) as overall_Salary_Rank,
    -> Dense_Rank() over(order by Salary desc) as Over_Dense_Rank
    -> from employees;
+--------+------------------+--------+------------------+---------------------+-----------------+
| emp_no | Department       | Salary | dept_Salary_Rank | overall_Salary_Rank | Over_Dense_Rank |
+--------+------------------+--------+------------------+---------------------+-----------------+
|     10 | sales            | 159000 |                1 |                   1 |               1 |
|      4 | engineering      | 103000 |                1 |                   2 |               2 |
|      7 | engineering      |  91000 |                2 |                   3 |               3 |
|      6 | engineering      |  89000 |                3 |                   4 |               4 |
|      1 | engineering      |  80000 |                4 |                   5 |               5 |
|     11 | sales            |  72000 |                2 |                   6 |               6 |
|      3 | engineering      |  70000 |                5 |                   7 |               7 |
|      9 | sales            |  70000 |                3 |                   7 |               7 |
|      2 | engineering      |  69000 |                6 |                   9 |               8 |
|      5 | engineering      |  67000 |                7 |                  10 |               9 |
|     17 | customer service |  61000 |                1 |                  11 |              10 |
|     13 | sales            |  61000 |                4 |                  11 |              10 |
|     14 | sales            |  61000 |                5 |                  11 |              10 |
|     12 | sales            |  60000 |                6 |                  14 |              11 |
|      8 | sales            |  59000 |                7 |                  15 |              12 |
|     20 | customer service |  56000 |                2 |                  16 |              13 |
|     21 | customer service |  55000 |                3 |                  17 |              14 |
|     16 | customer service |  45000 |                4 |                  18 |              15 |
|     18 | customer service |  40000 |                5 |                  19 |              16 |
|     15 | customer service |  38000 |                6 |                  20 |              17 |
|     19 | customer service |  31000 |                7 |                  21 |              18 |
+--------+------------------+--------+------------------+---------------------+-----------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary, Row_Number() over(partition by department order by Salary desc) as dept_Salary_Rank, Rank() over(order by salary desc) as overall_Salary_Rank, Dense_Rank() over(order by Salary desc) as Over_Dense_Rank from employees;
+--------+------------------+--------+------------------+---------------------+-----------------+
| emp_no | Department       | Salary | dept_Salary_Rank | overall_Salary_Rank | Over_Dense_Rank |
+--------+------------------+--------+------------------+---------------------+-----------------+
|     10 | sales            | 159000 |                1 |                   1 |               1 |
|      4 | engineering      | 103000 |                1 |                   2 |               2 |
|      7 | engineering      |  91000 |                2 |                   3 |               3 |
|      6 | engineering      |  89000 |                3 |                   4 |               4 |
|      1 | engineering      |  80000 |                4 |                   5 |               5 |
|     11 | sales            |  72000 |                2 |                   6 |               6 |
|      3 | engineering      |  70000 |                5 |                   7 |               7 |
|      9 | sales            |  70000 |                3 |                   7 |               7 |
|      2 | engineering      |  69000 |                6 |                   9 |               8 |
|      5 | engineering      |  67000 |                7 |                  10 |               9 |
|     17 | customer service |  61000 |                1 |                  11 |              10 |
|     13 | sales            |  61000 |                4 |                  11 |              10 |
|     14 | sales            |  61000 |                5 |                  11 |              10 |
|     12 | sales            |  60000 |                6 |                  14 |              11 |
|      8 | sales            |  59000 |                7 |                  15 |              12 |
|     20 | customer service |  56000 |                2 |                  16 |              13 |
|     21 | customer service |  55000 |                3 |                  17 |              14 |
|     16 | customer service |  45000 |                4 |                  18 |              15 |
|     18 | customer service |  40000 |                5 |                  19 |              16 |
|     15 | customer service |  38000 |                6 |                  20 |              17 |
|     19 | customer service |  31000 |                7 |                  21 |              18 |
+--------+------------------+--------+------------------+---------------------+-----------------+
21 rows in set (0.01 sec)

mysql> select  emp_no,Department,Salary,
    -> Row_Number() over(partition by department order by Salary desc) as dept_Salary_Rank,
    -> Rank() over(order by salary desc) as overall_Salary_Rank,
    -> Dense_Rank() over(order by Salary desc) as Over_Dense_Rank
    -> from employees
    -> order by overall_Salary_Rank;
+--------+------------------+--------+------------------+---------------------+-----------------+
| emp_no | Department       | Salary | dept_Salary_Rank | overall_Salary_Rank | Over_Dense_Rank |
+--------+------------------+--------+------------------+---------------------+-----------------+
|     10 | sales            | 159000 |                1 |                   1 |               1 |
|      4 | engineering      | 103000 |                1 |                   2 |               2 |
|      7 | engineering      |  91000 |                2 |                   3 |               3 |
|      6 | engineering      |  89000 |                3 |                   4 |               4 |
|      1 | engineering      |  80000 |                4 |                   5 |               5 |
|     11 | sales            |  72000 |                2 |                   6 |               6 |
|      3 | engineering      |  70000 |                5 |                   7 |               7 |
|      9 | sales            |  70000 |                3 |                   7 |               7 |
|      2 | engineering      |  69000 |                6 |                   9 |               8 |
|      5 | engineering      |  67000 |                7 |                  10 |               9 |
|     17 | customer service |  61000 |                1 |                  11 |              10 |
|     13 | sales            |  61000 |                4 |                  11 |              10 |
|     14 | sales            |  61000 |                5 |                  11 |              10 |
|     12 | sales            |  60000 |                6 |                  14 |              11 |
|      8 | sales            |  59000 |                7 |                  15 |              12 |
|     20 | customer service |  56000 |                2 |                  16 |              13 |
|     21 | customer service |  55000 |                3 |                  17 |              14 |
|     16 | customer service |  45000 |                4 |                  18 |              15 |
|     18 | customer service |  40000 |                5 |                  19 |              16 |
|     15 | customer service |  38000 |                6 |                  20 |              17 |
|     19 | customer service |  31000 |                7 |                  21 |              18 |
+--------+------------------+--------+------------------+---------------------+-----------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Row_Number() over(partition by department order by Salary desc) as dept_Salary_Rank,
    -> Rank() over(order by salary desc) as overall_Salary_Rank,
    -> Dense_Rank() over(order by Salary desc) as Over_Dense_Rank,
    -> Row_Number() over(order by Salary desc) as Over_Row_Num
    -> from employees
    -> order by overall_Salary_Rank;
+--------+------------------+--------+------------------+---------------------+-----------------+--------------+
| emp_no | Department       | Salary | dept_Salary_Rank | overall_Salary_Rank | Over_Dense_Rank | Over_Row_Num |
+--------+------------------+--------+------------------+---------------------+-----------------+--------------+
|     10 | sales            | 159000 |                1 |                   1 |               1 |            1 |
|      4 | engineering      | 103000 |                1 |                   2 |               2 |            2 |
|      7 | engineering      |  91000 |                2 |                   3 |               3 |            3 |
|      6 | engineering      |  89000 |                3 |                   4 |               4 |            4 |
|      1 | engineering      |  80000 |                4 |                   5 |               5 |            5 |
|     11 | sales            |  72000 |                2 |                   6 |               6 |            6 |
|      3 | engineering      |  70000 |                5 |                   7 |               7 |            7 |
|      9 | sales            |  70000 |                3 |                   7 |               7 |            8 |
|      2 | engineering      |  69000 |                6 |                   9 |               8 |            9 |
|      5 | engineering      |  67000 |                7 |                  10 |               9 |           10 |
|     17 | customer service |  61000 |                1 |                  11 |              10 |           11 |
|     13 | sales            |  61000 |                4 |                  11 |              10 |           12 |
|     14 | sales            |  61000 |                5 |                  11 |              10 |           13 |
|     12 | sales            |  60000 |                6 |                  14 |              11 |           14 |
|      8 | sales            |  59000 |                7 |                  15 |              12 |           15 |
|     20 | customer service |  56000 |                2 |                  16 |              13 |           16 |
|     21 | customer service |  55000 |                3 |                  17 |              14 |           17 |
|     16 | customer service |  45000 |                4 |                  18 |              15 |           18 |
|     18 | customer service |  40000 |                5 |                  19 |              16 |           19 |
|     15 | customer service |  38000 |                6 |                  20 |              17 |           20 |
|     19 | customer service |  31000 |                7 |                  21 |              18 |           21 |
+--------+------------------+--------+------------------+---------------------+-----------------+--------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Ntile(4) over(order by salary desc) as Ntile_Bucket_Number
    -> from employees;
+--------+------------------+--------+---------------------+
| emp_no | Department       | Salary | Ntile_Bucket_Number |
+--------+------------------+--------+---------------------+
|     10 | sales            | 159000 |                   1 |
|      4 | engineering      | 103000 |                   1 |
|      7 | engineering      |  91000 |                   1 |
|      6 | engineering      |  89000 |                   1 |
|      1 | engineering      |  80000 |                   1 |
|     11 | sales            |  72000 |                   1 |
|      3 | engineering      |  70000 |                   2 |
|      9 | sales            |  70000 |                   2 |
|      2 | engineering      |  69000 |                   2 |
|      5 | engineering      |  67000 |                   2 |
|     13 | sales            |  61000 |                   2 |
|     14 | sales            |  61000 |                   3 |
|     17 | customer service |  61000 |                   3 |
|     12 | sales            |  60000 |                   3 |
|      8 | sales            |  59000 |                   3 |
|     20 | customer service |  56000 |                   3 |
|     21 | customer service |  55000 |                   4 |
|     16 | customer service |  45000 |                   4 |
|     18 | customer service |  40000 |                   4 |
|     15 | customer service |  38000 |                   4 |
|     19 | customer service |  31000 |                   4 |
+--------+------------------+--------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Ntile(3) over(order by salary desc) as Ntile_Bucket_Number
    -> from employees;
+--------+------------------+--------+---------------------+
| emp_no | Department       | Salary | Ntile_Bucket_Number |
+--------+------------------+--------+---------------------+
|     10 | sales            | 159000 |                   1 |
|      4 | engineering      | 103000 |                   1 |
|      7 | engineering      |  91000 |                   1 |
|      6 | engineering      |  89000 |                   1 |
|      1 | engineering      |  80000 |                   1 |
|     11 | sales            |  72000 |                   1 |
|      3 | engineering      |  70000 |                   1 |
|      9 | sales            |  70000 |                   2 |
|      2 | engineering      |  69000 |                   2 |
|      5 | engineering      |  67000 |                   2 |
|     13 | sales            |  61000 |                   2 |
|     14 | sales            |  61000 |                   2 |
|     17 | customer service |  61000 |                   2 |
|     12 | sales            |  60000 |                   2 |
|      8 | sales            |  59000 |                   3 |
|     20 | customer service |  56000 |                   3 |
|     21 | customer service |  55000 |                   3 |
|     16 | customer service |  45000 |                   3 |
|     18 | customer service |  40000 |                   3 |
|     15 | customer service |  38000 |                   3 |
|     19 | customer service |  31000 |                   3 |
+--------+------------------+--------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Ntile(2) over(order by salary desc) as Ntile_Bucket_Number
    -> from employees;
+--------+------------------+--------+---------------------+
| emp_no | Department       | Salary | Ntile_Bucket_Number |
+--------+------------------+--------+---------------------+
|     10 | sales            | 159000 |                   1 |
|      4 | engineering      | 103000 |                   1 |
|      7 | engineering      |  91000 |                   1 |
|      6 | engineering      |  89000 |                   1 |
|      1 | engineering      |  80000 |                   1 |
|     11 | sales            |  72000 |                   1 |
|      3 | engineering      |  70000 |                   1 |
|      9 | sales            |  70000 |                   1 |
|      2 | engineering      |  69000 |                   1 |
|      5 | engineering      |  67000 |                   1 |
|     13 | sales            |  61000 |                   1 |
|     14 | sales            |  61000 |                   2 |
|     17 | customer service |  61000 |                   2 |
|     12 | sales            |  60000 |                   2 |
|      8 | sales            |  59000 |                   2 |
|     20 | customer service |  56000 |                   2 |
|     21 | customer service |  55000 |                   2 |
|     16 | customer service |  45000 |                   2 |
|     18 | customer service |  40000 |                   2 |
|     15 | customer service |  38000 |                   2 |
|     19 | customer service |  31000 |                   2 |
+--------+------------------+--------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> 
    -> Ntile(2) over() as Ntile_Bucket_Number
    -> from employees;
+--------+------------------+--------+---------------------+
| emp_no | Department       | Salary | Ntile_Bucket_Number |
+--------+------------------+--------+---------------------+
|      1 | engineering      |  80000 |                   1 |
|      2 | engineering      |  69000 |                   1 |
|      3 | engineering      |  70000 |                   1 |
|      4 | engineering      | 103000 |                   1 |
|      5 | engineering      |  67000 |                   1 |
|      6 | engineering      |  89000 |                   1 |
|      7 | engineering      |  91000 |                   1 |
|      8 | sales            |  59000 |                   1 |
|      9 | sales            |  70000 |                   1 |
|     10 | sales            | 159000 |                   1 |
|     11 | sales            |  72000 |                   1 |
|     12 | sales            |  60000 |                   2 |
|     13 | sales            |  61000 |                   2 |
|     14 | sales            |  61000 |                   2 |
|     15 | customer service |  38000 |                   2 |
|     16 | customer service |  45000 |                   2 |
|     17 | customer service |  61000 |                   2 |
|     18 | customer service |  40000 |                   2 |
|     19 | customer service |  31000 |                   2 |
|     20 | customer service |  56000 |                   2 |
|     21 | customer service |  55000 |                   2 |
+--------+------------------+--------+---------------------+
21 rows in set (0.00 sec)

mysql> 
mysql> select  emp_no,Department,Salary,
    -> 
    -> Ntile(2) over() as Ntile_Bucket_Number
    -> from employees;
+--------+------------------+--------+---------------------+
| emp_no | Department       | Salary | Ntile_Bucket_Number |
+--------+------------------+--------+---------------------+
|      1 | engineering      |  80000 |                   1 |
|      2 | engineering      |  69000 |                   1 |
|      3 | engineering      |  70000 |                   1 |
|      4 | engineering      | 103000 |                   1 |
|      5 | engineering      |  67000 |                   1 |
|      6 | engineering      |  89000 |                   1 |
|      7 | engineering      |  91000 |                   1 |
|      8 | sales            |  59000 |                   1 |
|      9 | sales            |  70000 |                   1 |
|     10 | sales            | 159000 |                   1 |
|     11 | sales            |  72000 |                   1 |
|     12 | sales            |  60000 |                   2 |
|     13 | sales            |  61000 |                   2 |
|     14 | sales            |  61000 |                   2 |
|     15 | customer service |  38000 |                   2 |
|     16 | customer service |  45000 |                   2 |
|     17 | customer service |  61000 |                   2 |
|     18 | customer service |  40000 |                   2 |
|     19 | customer service |  31000 |                   2 |
|     20 | customer service |  56000 |                   2 |
|     21 | customer service |  55000 |                   2 |
+--------+------------------+--------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> 
    -> Ntile(2) over(order by salary desc) as Ntile_Bucket_Number
    -> from employees;
+--------+------------------+--------+---------------------+
| emp_no | Department       | Salary | Ntile_Bucket_Number |
+--------+------------------+--------+---------------------+
|     10 | sales            | 159000 |                   1 |
|      4 | engineering      | 103000 |                   1 |
|      7 | engineering      |  91000 |                   1 |
|      6 | engineering      |  89000 |                   1 |
|      1 | engineering      |  80000 |                   1 |
|     11 | sales            |  72000 |                   1 |
|      3 | engineering      |  70000 |                   1 |
|      9 | sales            |  70000 |                   1 |
|      2 | engineering      |  69000 |                   1 |
|      5 | engineering      |  67000 |                   1 |
|     13 | sales            |  61000 |                   1 |
|     14 | sales            |  61000 |                   2 |
|     17 | customer service |  61000 |                   2 |
|     12 | sales            |  60000 |                   2 |
|      8 | sales            |  59000 |                   2 |
|     20 | customer service |  56000 |                   2 |
|     21 | customer service |  55000 |                   2 |
|     16 | customer service |  45000 |                   2 |
|     18 | customer service |  40000 |                   2 |
|     15 | customer service |  38000 |                   2 |
|     19 | customer service |  31000 |                   2 |
+--------+------------------+--------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Ntile(3) over(partition by department order by salary desc) as Ntile_Bucket_depart,
    -> Ntile(3) over(order by salary desc) as Ntile_Bucket_All
    -> from employees;
+--------+------------------+--------+---------------------+------------------+
| emp_no | Department       | Salary | Ntile_Bucket_depart | Ntile_Bucket_All |
+--------+------------------+--------+---------------------+------------------+
|     10 | sales            | 159000 |                   1 |                1 |
|      4 | engineering      | 103000 |                   1 |                1 |
|      7 | engineering      |  91000 |                   1 |                1 |
|      6 | engineering      |  89000 |                   1 |                1 |
|      1 | engineering      |  80000 |                   2 |                1 |
|     11 | sales            |  72000 |                   1 |                1 |
|      3 | engineering      |  70000 |                   2 |                1 |
|      9 | sales            |  70000 |                   1 |                2 |
|      2 | engineering      |  69000 |                   3 |                2 |
|      5 | engineering      |  67000 |                   3 |                2 |
|     17 | customer service |  61000 |                   1 |                2 |
|     13 | sales            |  61000 |                   2 |                2 |
|     14 | sales            |  61000 |                   2 |                2 |
|     12 | sales            |  60000 |                   3 |                2 |
|      8 | sales            |  59000 |                   3 |                3 |
|     20 | customer service |  56000 |                   1 |                3 |
|     21 | customer service |  55000 |                   1 |                3 |
|     16 | customer service |  45000 |                   2 |                3 |
|     18 | customer service |  40000 |                   2 |                3 |
|     15 | customer service |  38000 |                   3 |                3 |
|     19 | customer service |  31000 |                   3 |                3 |
+--------+------------------+--------+---------------------+------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Ntile(3) over(partition by department ) as Ntile_Bucket_depart,
    -> Ntile(3) over(order by salary desc) as Ntile_Bucket_All
    -> from employees;
+--------+------------------+--------+---------------------+------------------+
| emp_no | Department       | Salary | Ntile_Bucket_depart | Ntile_Bucket_All |
+--------+------------------+--------+---------------------+------------------+
|     10 | sales            | 159000 |                   1 |                1 |
|      4 | engineering      | 103000 |                   2 |                1 |
|      7 | engineering      |  91000 |                   3 |                1 |
|      6 | engineering      |  89000 |                   3 |                1 |
|      1 | engineering      |  80000 |                   1 |                1 |
|     11 | sales            |  72000 |                   2 |                1 |
|      3 | engineering      |  70000 |                   1 |                1 |
|      9 | sales            |  70000 |                   1 |                2 |
|      2 | engineering      |  69000 |                   1 |                2 |
|      5 | engineering      |  67000 |                   2 |                2 |
|     17 | customer service |  61000 |                   1 |                2 |
|     13 | sales            |  61000 |                   3 |                2 |
|     14 | sales            |  61000 |                   3 |                2 |
|     12 | sales            |  60000 |                   2 |                2 |
|      8 | sales            |  59000 |                   1 |                3 |
|     20 | customer service |  56000 |                   3 |                3 |
|     21 | customer service |  55000 |                   3 |                3 |
|     16 | customer service |  45000 |                   1 |                3 |
|     18 | customer service |  40000 |                   2 |                3 |
|     15 | customer service |  38000 |                   1 |                3 |
|     19 | customer service |  31000 |                   2 |                3 |
+--------+------------------+--------+---------------------+------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> avg(salary) over(Partition by department) as Dept_Avg from e
    -> mployees;
ERROR 1146 (42S02): Table 'windowfunc.e' doesn't exist
mysql> select  emp_no,Department,Salary, avg(salary) over(Partition by department) as Dept_Avg from employees;
+--------+------------------+--------+------------+
| emp_no | Department       | Salary | Dept_Avg   |
+--------+------------------+--------+------------+
|     15 | customer service |  38000 | 46571.4286 |
|     16 | customer service |  45000 | 46571.4286 |
|     17 | customer service |  61000 | 46571.4286 |
|     18 | customer service |  40000 | 46571.4286 |
|     19 | customer service |  31000 | 46571.4286 |
|     20 | customer service |  56000 | 46571.4286 |
|     21 | customer service |  55000 | 46571.4286 |
|      1 | engineering      |  80000 | 81285.7143 |
|      2 | engineering      |  69000 | 81285.7143 |
|      3 | engineering      |  70000 | 81285.7143 |
|      4 | engineering      | 103000 | 81285.7143 |
|      5 | engineering      |  67000 | 81285.7143 |
|      6 | engineering      |  89000 | 81285.7143 |
|      7 | engineering      |  91000 | 81285.7143 |
|      8 | sales            |  59000 | 77428.5714 |
|      9 | sales            |  70000 | 77428.5714 |
|     10 | sales            | 159000 | 77428.5714 |
|     11 | sales            |  72000 | 77428.5714 |
|     12 | sales            |  60000 | 77428.5714 |
|     13 | sales            |  61000 | 77428.5714 |
|     14 | sales            |  61000 | 77428.5714 |
+--------+------------------+--------+------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Ntile(3) over(partition by department ) as Ntile_Bucket_depart,
    -> Ntile(3) over(order by salary desc) as Ntile_Bucket_All
    -> from employees;
+--------+------------------+--------+---------------------+------------------+
| emp_no | Department       | Salary | Ntile_Bucket_depart | Ntile_Bucket_All |
+--------+------------------+--------+---------------------+------------------+
|     10 | sales            | 159000 |                   1 |                1 |
|      4 | engineering      | 103000 |                   2 |                1 |
|      7 | engineering      |  91000 |                   3 |                1 |
|      6 | engineering      |  89000 |                   3 |                1 |
|      1 | engineering      |  80000 |                   1 |                1 |
|     11 | sales            |  72000 |                   2 |                1 |
|      3 | engineering      |  70000 |                   1 |                1 |
|      9 | sales            |  70000 |                   1 |                2 |
|      2 | engineering      |  69000 |                   1 |                2 |
|      5 | engineering      |  67000 |                   2 |                2 |
|     17 | customer service |  61000 |                   1 |                2 |
|     13 | sales            |  61000 |                   3 |                2 |
|     14 | sales            |  61000 |                   3 |                2 |
|     12 | sales            |  60000 |                   2 |                2 |
|      8 | sales            |  59000 |                   1 |                3 |
|     20 | customer service |  56000 |                   3 |                3 |
|     21 | customer service |  55000 |                   3 |                3 |
|     16 | customer service |  45000 |                   1 |                3 |
|     18 | customer service |  40000 |                   2 |                3 |
|     15 | customer service |  38000 |                   1 |                3 |
|     19 | customer service |  31000 |                   2 |                3 |
+--------+------------------+--------+---------------------+------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Ntile(3) over(partition by department) as Ntile_Bucket_depart,
    -> from employees;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'from employees' at line 3
mysql> select  emp_no,Department,Salary,
    -> Ntile(3) over(partition by department) as Ntile_Bucket_depart
    -> from employees;
+--------+------------------+--------+---------------------+
| emp_no | Department       | Salary | Ntile_Bucket_depart |
+--------+------------------+--------+---------------------+
|     15 | customer service |  38000 |                   1 |
|     16 | customer service |  45000 |                   1 |
|     17 | customer service |  61000 |                   1 |
|     18 | customer service |  40000 |                   2 |
|     19 | customer service |  31000 |                   2 |
|     20 | customer service |  56000 |                   3 |
|     21 | customer service |  55000 |                   3 |
|      1 | engineering      |  80000 |                   1 |
|      2 | engineering      |  69000 |                   1 |
|      3 | engineering      |  70000 |                   1 |
|      4 | engineering      | 103000 |                   2 |
|      5 | engineering      |  67000 |                   2 |
|      6 | engineering      |  89000 |                   3 |
|      7 | engineering      |  91000 |                   3 |
|      8 | sales            |  59000 |                   1 |
|      9 | sales            |  70000 |                   1 |
|     10 | sales            | 159000 |                   1 |
|     11 | sales            |  72000 |                   2 |
|     12 | sales            |  60000 |                   2 |
|     13 | sales            |  61000 |                   3 |
|     14 | sales            |  61000 |                   3 |
+--------+------------------+--------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Ntile(2) over(partition by department) as Ntile_Bucket_depart
    -> from employees;
+--------+------------------+--------+---------------------+
| emp_no | Department       | Salary | Ntile_Bucket_depart |
+--------+------------------+--------+---------------------+
|     15 | customer service |  38000 |                   1 |
|     16 | customer service |  45000 |                   1 |
|     17 | customer service |  61000 |                   1 |
|     18 | customer service |  40000 |                   1 |
|     19 | customer service |  31000 |                   2 |
|     20 | customer service |  56000 |                   2 |
|     21 | customer service |  55000 |                   2 |
|      1 | engineering      |  80000 |                   1 |
|      2 | engineering      |  69000 |                   1 |
|      3 | engineering      |  70000 |                   1 |
|      4 | engineering      | 103000 |                   1 |
|      5 | engineering      |  67000 |                   2 |
|      6 | engineering      |  89000 |                   2 |
|      7 | engineering      |  91000 |                   2 |
|      8 | sales            |  59000 |                   1 |
|      9 | sales            |  70000 |                   1 |
|     10 | sales            | 159000 |                   1 |
|     11 | sales            |  72000 |                   1 |
|     12 | sales            |  60000 |                   2 |
|     13 | sales            |  61000 |                   2 |
|     14 | sales            |  61000 |                   2 |
+--------+------------------+--------+---------------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Ntile(4) over(partition by department order by salary desc) as Ntile_Bucket_depart,
    -> Ntile(4) over(order by salary desc) as Over_alll
    -> from employees;
+--------+------------------+--------+---------------------+-----------+
| emp_no | Department       | Salary | Ntile_Bucket_depart | Over_alll |
+--------+------------------+--------+---------------------+-----------+
|     10 | sales            | 159000 |                   1 |         1 |
|      4 | engineering      | 103000 |                   1 |         1 |
|      7 | engineering      |  91000 |                   1 |         1 |
|      6 | engineering      |  89000 |                   2 |         1 |
|      1 | engineering      |  80000 |                   2 |         1 |
|     11 | sales            |  72000 |                   1 |         1 |
|      3 | engineering      |  70000 |                   3 |         2 |
|      9 | sales            |  70000 |                   2 |         2 |
|      2 | engineering      |  69000 |                   3 |         2 |
|      5 | engineering      |  67000 |                   4 |         2 |
|     17 | customer service |  61000 |                   1 |         2 |
|     13 | sales            |  61000 |                   2 |         3 |
|     14 | sales            |  61000 |                   3 |         3 |
|     12 | sales            |  60000 |                   3 |         3 |
|      8 | sales            |  59000 |                   4 |         3 |
|     20 | customer service |  56000 |                   1 |         3 |
|     21 | customer service |  55000 |                   2 |         4 |
|     16 | customer service |  45000 |                   2 |         4 |
|     18 | customer service |  40000 |                   3 |         4 |
|     15 | customer service |  38000 |                   3 |         4 |
|     19 | customer service |  31000 |                   4 |         4 |
+--------+------------------+--------+---------------------+-----------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> Ntile(4) over(partition by department order by salary) as Ntile_Bucket_depart,
    -> Ntile(4) over(order by salary) as Over_alll
    -> from employees;
+--------+------------------+--------+---------------------+-----------+
| emp_no | Department       | Salary | Ntile_Bucket_depart | Over_alll |
+--------+------------------+--------+---------------------+-----------+
|     19 | customer service |  31000 |                   1 |         1 |
|     15 | customer service |  38000 |                   1 |         1 |
|     18 | customer service |  40000 |                   2 |         1 |
|     16 | customer service |  45000 |                   2 |         1 |
|     21 | customer service |  55000 |                   3 |         1 |
|     20 | customer service |  56000 |                   3 |         1 |
|      8 | sales            |  59000 |                   1 |         2 |
|     12 | sales            |  60000 |                   1 |         2 |
|     17 | customer service |  61000 |                   4 |         2 |
|     13 | sales            |  61000 |                   2 |         2 |
|     14 | sales            |  61000 |                   2 |         2 |
|      5 | engineering      |  67000 |                   1 |         3 |
|      2 | engineering      |  69000 |                   1 |         3 |
|      3 | engineering      |  70000 |                   2 |         3 |
|      9 | sales            |  70000 |                   3 |         3 |
|     11 | sales            |  72000 |                   3 |         3 |
|      1 | engineering      |  80000 |                   2 |         4 |
|      6 | engineering      |  89000 |                   3 |         4 |
|      7 | engineering      |  91000 |                   3 |         4 |
|      4 | engineering      | 103000 |                   4 |         4 |
|     10 | sales            | 159000 |                   4 |         4 |
+--------+------------------+--------+---------------------+-----------+
21 rows in set (0.01 sec)

mysql> select  emp_no,Department,Salary,
    -> first_Value(EMP_NO) over(order by salary desc) as Hgh_paid_Id
    -> from employees;
+--------+------------------+--------+-------------+
| emp_no | Department       | Salary | Hgh_paid_Id |
+--------+------------------+--------+-------------+
|     10 | sales            | 159000 |          10 |
|      4 | engineering      | 103000 |          10 |
|      7 | engineering      |  91000 |          10 |
|      6 | engineering      |  89000 |          10 |
|      1 | engineering      |  80000 |          10 |
|     11 | sales            |  72000 |          10 |
|      3 | engineering      |  70000 |          10 |
|      9 | sales            |  70000 |          10 |
|      2 | engineering      |  69000 |          10 |
|      5 | engineering      |  67000 |          10 |
|     13 | sales            |  61000 |          10 |
|     14 | sales            |  61000 |          10 |
|     17 | customer service |  61000 |          10 |
|     12 | sales            |  60000 |          10 |
|      8 | sales            |  59000 |          10 |
|     20 | customer service |  56000 |          10 |
|     21 | customer service |  55000 |          10 |
|     16 | customer service |  45000 |          10 |
|     18 | customer service |  40000 |          10 |
|     15 | customer service |  38000 |          10 |
|     19 | customer service |  31000 |          10 |
+--------+------------------+--------+-------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> first_Value(EMP_NO) over(order by salary) as Hgh_paid_Id
    -> from employees;
+--------+------------------+--------+-------------+
| emp_no | Department       | Salary | Hgh_paid_Id |
+--------+------------------+--------+-------------+
|     19 | customer service |  31000 |          19 |
|     15 | customer service |  38000 |          19 |
|     18 | customer service |  40000 |          19 |
|     16 | customer service |  45000 |          19 |
|     21 | customer service |  55000 |          19 |
|     20 | customer service |  56000 |          19 |
|      8 | sales            |  59000 |          19 |
|     12 | sales            |  60000 |          19 |
|     13 | sales            |  61000 |          19 |
|     14 | sales            |  61000 |          19 |
|     17 | customer service |  61000 |          19 |
|      5 | engineering      |  67000 |          19 |
|      2 | engineering      |  69000 |          19 |
|      3 | engineering      |  70000 |          19 |
|      9 | sales            |  70000 |          19 |
|     11 | sales            |  72000 |          19 |
|      1 | engineering      |  80000 |          19 |
|      6 | engineering      |  89000 |          19 |
|      7 | engineering      |  91000 |          19 |
|      4 | engineering      | 103000 |          19 |
|     10 | sales            | 159000 |          19 |
+--------+------------------+--------+-------------+
21 rows in set (0.00 sec)

mysql> 
mysql> select  emp_no,Department,Salary,
    -> first_Value(EMP_NO) over(partition by department order by salary Desc) as Hgh_paid_Id
    -> from employees;
+--------+------------------+--------+-------------+
| emp_no | Department       | Salary | Hgh_paid_Id |
+--------+------------------+--------+-------------+
|     17 | customer service |  61000 |          17 |
|     20 | customer service |  56000 |          17 |
|     21 | customer service |  55000 |          17 |
|     16 | customer service |  45000 |          17 |
|     18 | customer service |  40000 |          17 |
|     15 | customer service |  38000 |          17 |
|     19 | customer service |  31000 |          17 |
|      4 | engineering      | 103000 |           4 |
|      7 | engineering      |  91000 |           4 |
|      6 | engineering      |  89000 |           4 |
|      1 | engineering      |  80000 |           4 |
|      3 | engineering      |  70000 |           4 |
|      2 | engineering      |  69000 |           4 |
|      5 | engineering      |  67000 |           4 |
|     10 | sales            | 159000 |          10 |
|     11 | sales            |  72000 |          10 |
|      9 | sales            |  70000 |          10 |
|     13 | sales            |  61000 |          10 |
|     14 | sales            |  61000 |          10 |
|     12 | sales            |  60000 |          10 |
|      8 | sales            |  59000 |          10 |
+--------+------------------+--------+-------------+
21 rows in set (0.00 sec)

mysql> 
mysql> select  emp_no,Department,Salary,
    -> first_Value(EMP_NO) over(partition by department order by salary) as Hgh_paid_Id
    -> from employees;
+--------+------------------+--------+-------------+
| emp_no | Department       | Salary | Hgh_paid_Id |
+--------+------------------+--------+-------------+
|     19 | customer service |  31000 |          19 |
|     15 | customer service |  38000 |          19 |
|     18 | customer service |  40000 |          19 |
|     16 | customer service |  45000 |          19 |
|     21 | customer service |  55000 |          19 |
|     20 | customer service |  56000 |          19 |
|     17 | customer service |  61000 |          19 |
|      5 | engineering      |  67000 |           5 |
|      2 | engineering      |  69000 |           5 |
|      3 | engineering      |  70000 |           5 |
|      1 | engineering      |  80000 |           5 |
|      6 | engineering      |  89000 |           5 |
|      7 | engineering      |  91000 |           5 |
|      4 | engineering      | 103000 |           5 |
|      8 | sales            |  59000 |           8 |
|     12 | sales            |  60000 |           8 |
|     13 | sales            |  61000 |           8 |
|     14 | sales            |  61000 |           8 |
|      9 | sales            |  70000 |           8 |
|     11 | sales            |  72000 |           8 |
|     10 | sales            | 159000 |           8 |
+--------+------------------+--------+-------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> lag(salary) over(order by salary desc) as Precedes_Row
    -> from employees;
+--------+------------------+--------+--------------+
| emp_no | Department       | Salary | Precedes_Row |
+--------+------------------+--------+--------------+
|     10 | sales            | 159000 |         NULL |
|      4 | engineering      | 103000 |       159000 |
|      7 | engineering      |  91000 |       103000 |
|      6 | engineering      |  89000 |        91000 |
|      1 | engineering      |  80000 |        89000 |
|     11 | sales            |  72000 |        80000 |
|      3 | engineering      |  70000 |        72000 |
|      9 | sales            |  70000 |        70000 |
|      2 | engineering      |  69000 |        70000 |
|      5 | engineering      |  67000 |        69000 |
|     13 | sales            |  61000 |        67000 |
|     14 | sales            |  61000 |        61000 |
|     17 | customer service |  61000 |        61000 |
|     12 | sales            |  60000 |        61000 |
|      8 | sales            |  59000 |        60000 |
|     20 | customer service |  56000 |        59000 |
|     21 | customer service |  55000 |        56000 |
|     16 | customer service |  45000 |        55000 |
|     18 | customer service |  40000 |        45000 |
|     15 | customer service |  38000 |        40000 |
|     19 | customer service |  31000 |        38000 |
+--------+------------------+--------+--------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> lag(emp_no) over(order by emp_no desc) as Precedes_Row
    -> from employees;
+--------+------------------+--------+--------------+
| emp_no | Department       | Salary | Precedes_Row |
+--------+------------------+--------+--------------+
|     21 | customer service |  55000 |         NULL |
|     20 | customer service |  56000 |           21 |
|     19 | customer service |  31000 |           20 |
|     18 | customer service |  40000 |           19 |
|     17 | customer service |  61000 |           18 |
|     16 | customer service |  45000 |           17 |
|     15 | customer service |  38000 |           16 |
|     14 | sales            |  61000 |           15 |
|     13 | sales            |  61000 |           14 |
|     12 | sales            |  60000 |           13 |
|     11 | sales            |  72000 |           12 |
|     10 | sales            | 159000 |           11 |
|      9 | sales            |  70000 |           10 |
|      8 | sales            |  59000 |            9 |
|      7 | engineering      |  91000 |            8 |
|      6 | engineering      |  89000 |            7 |
|      5 | engineering      |  67000 |            6 |
|      4 | engineering      | 103000 |            5 |
|      3 | engineering      |  70000 |            4 |
|      2 | engineering      |  69000 |            3 |
|      1 | engineering      |  80000 |            2 |
+--------+------------------+--------+--------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> lag(salary)- salary over(order by salary desc) as Precedes_Row
    -> from employees;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '- salary over(order by salary desc) as Precedes_Row
from employees' at line 2
mysql> select  emp_no,Department,Salary,
    -> salary-lag(salary) over(order by salary desc) as Precedes_Row
    -> from employees;
+--------+------------------+--------+--------------+
| emp_no | Department       | Salary | Precedes_Row |
+--------+------------------+--------+--------------+
|     10 | sales            | 159000 |         NULL |
|      4 | engineering      | 103000 |       -56000 |
|      7 | engineering      |  91000 |       -12000 |
|      6 | engineering      |  89000 |        -2000 |
|      1 | engineering      |  80000 |        -9000 |
|     11 | sales            |  72000 |        -8000 |
|      3 | engineering      |  70000 |        -2000 |
|      9 | sales            |  70000 |            0 |
|      2 | engineering      |  69000 |        -1000 |
|      5 | engineering      |  67000 |        -2000 |
|     13 | sales            |  61000 |        -6000 |
|     14 | sales            |  61000 |            0 |
|     17 | customer service |  61000 |            0 |
|     12 | sales            |  60000 |        -1000 |
|      8 | sales            |  59000 |        -1000 |
|     20 | customer service |  56000 |        -3000 |
|     21 | customer service |  55000 |        -1000 |
|     16 | customer service |  45000 |       -10000 |
|     18 | customer service |  40000 |        -5000 |
|     15 | customer service |  38000 |        -2000 |
|     19 | customer service |  31000 |        -7000 |
+--------+------------------+--------+--------------+
21 rows in set (0.00 sec)

mysql> 
mysql> select  emp_no,Department,Salary,
    -> emp_no-lag(emp_no) over(order by emp_no desc) as Precedes_Row
    -> from employees;
+--------+------------------+--------+--------------+
| emp_no | Department       | Salary | Precedes_Row |
+--------+------------------+--------+--------------+
|     21 | customer service |  55000 |         NULL |
|     20 | customer service |  56000 |           -1 |
|     19 | customer service |  31000 |           -1 |
|     18 | customer service |  40000 |           -1 |
|     17 | customer service |  61000 |           -1 |
|     16 | customer service |  45000 |           -1 |
|     15 | customer service |  38000 |           -1 |
|     14 | sales            |  61000 |           -1 |
|     13 | sales            |  61000 |           -1 |
|     12 | sales            |  60000 |           -1 |
|     11 | sales            |  72000 |           -1 |
|     10 | sales            | 159000 |           -1 |
|      9 | sales            |  70000 |           -1 |
|      8 | sales            |  59000 |           -1 |
|      7 | engineering      |  91000 |           -1 |
|      6 | engineering      |  89000 |           -1 |
|      5 | engineering      |  67000 |           -1 |
|      4 | engineering      | 103000 |           -1 |
|      3 | engineering      |  70000 |           -1 |
|      2 | engineering      |  69000 |           -1 |
|      1 | engineering      |  80000 |           -1 |
+--------+------------------+--------+--------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> salary-lag(Salary) over(partition by department order by salary desc) as Precedes_Row
    -> from employees;
+--------+------------------+--------+--------------+
| emp_no | Department       | Salary | Precedes_Row |
+--------+------------------+--------+--------------+
|     17 | customer service |  61000 |         NULL |
|     20 | customer service |  56000 |        -5000 |
|     21 | customer service |  55000 |        -1000 |
|     16 | customer service |  45000 |       -10000 |
|     18 | customer service |  40000 |        -5000 |
|     15 | customer service |  38000 |        -2000 |
|     19 | customer service |  31000 |        -7000 |
|      4 | engineering      | 103000 |         NULL |
|      7 | engineering      |  91000 |       -12000 |
|      6 | engineering      |  89000 |        -2000 |
|      1 | engineering      |  80000 |        -9000 |
|      3 | engineering      |  70000 |       -10000 |
|      2 | engineering      |  69000 |        -1000 |
|      5 | engineering      |  67000 |        -2000 |
|     10 | sales            | 159000 |         NULL |
|     11 | sales            |  72000 |       -87000 |
|      9 | sales            |  70000 |        -2000 |
|     13 | sales            |  61000 |        -9000 |
|     14 | sales            |  61000 |            0 |
|     12 | sales            |  60000 |        -1000 |
|      8 | sales            |  59000 |        -1000 |
+--------+------------------+--------+--------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> lead(Salary) over(order by salary desc) as follows_Row
    -> from employees;
+--------+------------------+--------+-------------+
| emp_no | Department       | Salary | follows_Row |
+--------+------------------+--------+-------------+
|     10 | sales            | 159000 |      103000 |
|      4 | engineering      | 103000 |       91000 |
|      7 | engineering      |  91000 |       89000 |
|      6 | engineering      |  89000 |       80000 |
|      1 | engineering      |  80000 |       72000 |
|     11 | sales            |  72000 |       70000 |
|      3 | engineering      |  70000 |       70000 |
|      9 | sales            |  70000 |       69000 |
|      2 | engineering      |  69000 |       67000 |
|      5 | engineering      |  67000 |       61000 |
|     13 | sales            |  61000 |       61000 |
|     14 | sales            |  61000 |       61000 |
|     17 | customer service |  61000 |       60000 |
|     12 | sales            |  60000 |       59000 |
|      8 | sales            |  59000 |       56000 |
|     20 | customer service |  56000 |       55000 |
|     21 | customer service |  55000 |       45000 |
|     16 | customer service |  45000 |       40000 |
|     18 | customer service |  40000 |       38000 |
|     15 | customer service |  38000 |       31000 |
|     19 | customer service |  31000 |        NULL |
+--------+------------------+--------+-------------+
21 rows in set (0.00 sec)

mysql> select  emp_no,Department,Salary,
    -> salary-lead(Salary) over(order by salary desc) as follows_Row
    -> from employees;
+--------+------------------+--------+-------------+
| emp_no | Department       | Salary | follows_Row |
+--------+------------------+--------+-------------+
|     10 | sales            | 159000 |       56000 |
|      4 | engineering      | 103000 |       12000 |
|      7 | engineering      |  91000 |        2000 |
|      6 | engineering      |  89000 |        9000 |
|      1 | engineering      |  80000 |        8000 |
|     11 | sales            |  72000 |        2000 |
|      3 | engineering      |  70000 |           0 |
|      9 | sales            |  70000 |        1000 |
|      2 | engineering      |  69000 |        2000 |
|      5 | engineering      |  67000 |        6000 |
|     13 | sales            |  61000 |           0 |
|     14 | sales            |  61000 |           0 |
|     17 | customer service |  61000 |        1000 |
|     12 | sales            |  60000 |        1000 |
|      8 | sales            |  59000 |        3000 |
|     20 | customer service |  56000 |        1000 |
|     21 | customer service |  55000 |       10000 |
|     16 | customer service |  45000 |        5000 |
|     18 | customer service |  40000 |        2000 |
|     15 | customer service |  38000 |        7000 |
|     19 | customer service |  31000 |        NULL |
+--------+------------------+--------+-------------+
21 rows in set (0.00 sec)

mysql> 
mysql> 
